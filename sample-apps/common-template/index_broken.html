<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Áµ±Âêà„Ç¢„Éó„É™ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É† v1.0</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --primary: #4CAF50;
            --secondary: #2196F3;
            --warning: #FF9800;
            --danger: #f44336;
            --success: #4CAF50;
            --bg: #f8f9fa;
            --surface: #fff;
            --text: #333;
            --text-light: #666;
            --border: #ddd;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --border-radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        header {
            background: var(--surface);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            color: var(--primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .version-badge {
            background: var(--secondary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: normal;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .auth-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .auth-btn:hover {
            opacity: 0.9;
        }

        /* „Ç¢„Éó„É™„Çø„Éñ */
        .app-tabs {
            display: flex;
            background: var(--surface);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .app-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 15px 20px;
            cursor: pointer;
            border: none;
            background: none;
            color: var(--text-light);
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .app-tab:hover {
            background: var(--bg);
            color: var(--text);
        }

        .app-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: var(--bg);
        }

        .app-tab .icon {
            font-size: 1.2rem;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */
        .main-content {
            background: var(--surface);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            min-height: 500px;
        }

        .app-content {
            display: none;
            padding: 20px;
        }

        .app-content.active {
            display: block;
        }

        .welcome-content {
            text-align: center;
            padding: 60px 20px;
        }

        .welcome-content h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .welcome-content p {
            color: var(--text-light);
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        /* „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†± */
        .system-info {
            background: var(--bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-card {
            background: var(--surface);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--primary);
        }

        .info-card h4 {
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .info-card p {
            color: var(--text);
            font-weight: 500;
        }

        /* „Éú„Çø„É≥ */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-danger {
            background: var(--danger);
        }

        /* „É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥ */
        .log-section {
            margin-top: 20px;
        }

        .log-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .debug-logs {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-line;
        }

        /* Ë®≠ÂÆö„Éë„Éç„É´ */
        .settings-panel {
            background: var(--bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        /* „ÅäÈáëÁÆ°ÁêÜÁîªÈù¢ */
        .money-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .input-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .input-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .form-control {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            flex: 1;
            min-width: 120px;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
        }

        .transaction-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .transactions-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-income {
            border-left: 4px solid var(--success);
        }

        .transaction-expense {
            border-left: 4px solid var(--danger);
        }

        /* ÊôÇÈñìÁÆ°ÁêÜ„Éª‰ΩìÈáçÁÆ°ÁêÜÁîªÈù¢ */
        .time-panel, .weight-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .timer-section, .bmi-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
        }

        .timer-display, .bmi-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 20px;
            margin: 10px 0;
        }

        .timer-clock {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }

        .timer-controls {
            margin: 15px 0;
        }

        .timer-task {
            font-size: 1.1rem;
            color: #666;
            margin-top: 10px;
        }

        .bmi-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .bmi-status {
            font-size: 1.2rem;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }

        .bmi-underweight { background: #e3f2fd; color: #1976d2; }
        .bmi-normal { background: #e8f5e8; color: #388e3c; }
        .bmi-overweight { background: #fff3e0; color: #f57c00; }
        .bmi-obese { background: #ffebee; color: #d32f2f; }

        .time-list, .weight-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .records-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
        }

        .record-item:last-child {
            border-bottom: none;
        }

        .record-work { border-left: 4px solid #2196F3; }
        .record-study { border-left: 4px solid #4CAF50; }
        .record-exercise { border-left: 4px solid #FF9800; }
        .record-break { border-left: 4px solid #9C27B0; }
        .record-other { border-left: 4px solid #607D8B; }

        /* „É°„É¢ÁÆ°ÁêÜÁîªÈù¢ */
        .memo-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .memo-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .memo-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
        }

        .memo-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .memo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .memo-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }

        .memo-category {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .memo-content {
            margin: 10px 0;
            line-height: 1.5;
            color: #555;
            white-space: pre-wrap;
        }

        .memo-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .memo-tags {
            display: flex;
            gap: 5px;
        }

        .memo-tag {
            background: #e9ecef;
            color: #495057;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .memo-delete-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .memo-delete-btn:hover {
            opacity: 0.8;
        }

        /* „Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ */
        .memo-filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .filter-input-section {
            margin-bottom: 15px;
        }

        .filter-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            min-height: 40px;
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .filter-keyword-tag {
            display: inline-flex;
            align-items: center;
            background: var(--primary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            gap: 8px;
            animation: fadeIn 0.3s ease-in;
        }

        .filter-keyword-tag .remove-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .filter-keyword-tag .remove-btn:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .filter-empty-state {
            color: #999;
            font-style: italic;
            padding: 10px;
            text-align: center;
        }

        /* Ë®àÁÆóÊ©ü„Çπ„Çø„Ç§„É´ */
        .calc-form {
            background: var(--surface);
            padding: 20px;
            border-radius: var(--border-radius);
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .calc-input-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .calc-input {
            width: 120px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }

        .calc-operator, .calc-equals {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            min-width: 30px;
            text-align: center;
        }

        .calc-result {
            font-size: 24px;
            font-weight: bold;
            color: var(--success);
            min-width: 100px;
            background: var(--bg);
            padding: 8px 15px;
            border-radius: 6px;
            border: 2px solid var(--success);
            text-align: center;
        }

        .calc-button-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .calc-btn {
            background: var(--primary);
            font-size: 16px;
            font-weight: bold;
            min-width: 120px;
        }

        .calc-history-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--surface);
        }

        .calc-history-item {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .calc-history-item:last-child {
            border-bottom: none;
        }

        .calc-history-item:hover {
            background: var(--bg);
        }

        .calc-expression {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
        }

        .calc-timestamp {
            color: var(--text-light);
            font-size: 12px;
        }

        .calc-delete-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .calc-delete-btn:hover {
            opacity: 0.8;
        }

        .config-editor {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            width: 100%;
            min-height: 200px;
            resize: vertical;
        }

        /* Ë®≠ÂÆöÁÆ°ÁêÜUI */
        .config-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .checkbox-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg);
            transition: background-color 0.2s;
        }

        .checkbox-item:hover {
            background: #f0f0f0;
        }

        .checkbox-item input[type="checkbox"] {
            margin: 0;
            transform: scale(1.1);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            flex: 1;
            font-weight: normal;
        }

        .checkbox-item.enabled {
            background: #e8f5e8;
            border-color: var(--success);
        }

        .app-icon {
            font-size: 16px;
            margin-right: 4px;
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .app-tabs {
                flex-direction: column;
            }
            
            .app-tab {
                justify-content: center;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
        }

        /* „É≠„Éº„Éá„Ç£„É≥„Ç∞ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫ */
        .status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .status-success {
            background: #e8f5e8;
            color: #2e7d2e;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
        }

        /* „É≠„Ç∞Èñ≤Ë¶ßÁîªÈù¢ */
        .logs-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .log-selection, .log-search, .log-content {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--bg);
            border-radius: 6px;
        }

        .log-controls, .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .log-display {
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            padding: 15px;
            border-radius: 4px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #333;
        }

        .log-line {
            padding: 2px 0;
            border-bottom: 1px solid #333;
        }

        .log-line:last-child {
            border-bottom: none;
        }

        .log-line.highlight {
            background: #264f78;
            color: #ffffff;
        }

        .log-header {
            background: #2d4a5a !important;
            color: #87ceeb !important;
            font-weight: bold;
            border: none !important;
        }

        .file-name {
            color: #87ceeb;
            font-size: 0.9rem;
            font-weight: normal;
            opacity: 0.8;
        }

        .search-count {
            color: var(--primary);
            font-weight: bold;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <header>
            <h1>
                üöÄ Áµ±Âêà„Ç¢„Éó„É™ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†
                <span class="version-badge">v0.3</span>
            </h1>
            <div class="user-info" id="userInfo">
                <div class="status" id="connectionStatus">
                    <span class="loading"></span>
                    <span>Êé•Á∂ö‰∏≠...</span>
                </div>
                <button class="auth-btn" id="authBtn">Google„Åß„É≠„Ç∞„Ç§„É≥</button>
            </div>
        </header>

        <!-- „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†± -->
        <div class="system-info">
            <h3>üìä „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±</h3>
            <div class="info-grid" id="systemInfo">
                <div class="info-card">
                    <h4>„Éê„Éº„Ç∏„Éß„É≥</h4>
                    <p id="version">0.3</p>
                </div>
                <div class="info-card">
                    <h4>ÊúâÂäπ„Ç¢„Éó„É™Êï∞</h4>
                    <p id="enabledApps">Ë™≠„ÅøËæº„Åø‰∏≠...</p>
                </div>
            </div>
        </div>

        <!-- „Ç¢„Éó„É™„Çø„Éñ -->
        <div class="app-tabs" id="appTabs">
            <button class="app-tab active" data-app="simple">
                <span class="icon">üìÑ</span>
                <span>„Ç∑„É≥„Éó„É´</span>
            </button>
            <button class="app-tab" data-app="settings">
                <span class="icon">‚öôÔ∏è</span>
                <span>Ë®≠ÂÆö</span>
            </button>
            <button class="app-tab" data-app="logs">
                <span class="icon">üìã</span>
                <span>„É≠„Ç∞</span>
            </button>
        </div>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <div class="main-content">
            <!-- „Ç∑„É≥„Éó„É´„Çµ„É≥„Éó„É´„Ç¢„Éó„É™ÁîªÈù¢ -->
            <div class="app-content active" id="simple-content">
                <!-- ÂãïÁöÑ„Å´Ë™≠„ÅøËæº„Åæ„Çå„Çã -->
            </div>

            <!-- Ë®≠ÂÆöÁîªÈù¢ -->
            <div class="app-content" id="settings-content">
                <div class="settings-panel">
                    <h3>‚öôÔ∏è Ë®≠ÂÆöÁÆ°ÁêÜ</h3>
                    <p>config.json „ÅÆÂÜÖÂÆπ„ÇíÁ∑®ÈõÜ„Åß„Åç„Åæ„Åô„ÄÇÂ§âÊõ¥Âæå„ÅØ„ÄåË®≠ÂÆö„Çí‰øùÂ≠ò„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                    
                    <!-- „Ç¢„Éó„É™ÊúâÂäπÂåñË®≠ÂÆö -->
                    <div class="config-section">
                        <h4>üì± ÊúâÂäπ„Å™„Ç¢„Éó„É™</h4>
                        <div class="checkbox-list" id="enabledAppsCheckboxes">
                            <div class="loading">Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>

                    <!-- Ê©üËÉΩË®≠ÂÆö -->
                    <div class="config-section">
                        <h4>‚öôÔ∏è Ê©üËÉΩË®≠ÂÆö</h4>
                        <div class="checkbox-list" id="featuresCheckboxes">
                            <div class="loading">Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>

                    <!-- ‰øùÂ≠ò„Éª„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥ -->
                    <div style="margin: 20px 0;">
                        <button class="btn" onclick="loadConfigUI()">üì• Ë®≠ÂÆöË™≠„ÅøËæº„Åø</button>
                        <button class="btn btn-secondary" onclick="saveConfigUI()">üíæ Ë®≠ÂÆö‰øùÂ≠ò</button>
                        <button class="btn btn-warning" onclick="resetConfig()">üîÑ „É™„Çª„ÉÉ„Éà</button>
                    </div>
                    
                    <!-- È´òÂ∫¶„Å™Ë®≠ÂÆöÔºàJSONÁ∑®ÈõÜÔºâ -->
                    <div class="config-section">
                        <h4>üîß È´òÂ∫¶„Å™Ë®≠ÂÆö (JSON)</h4>
                        <details>
                            <summary>„Ç®„É≥„Ç∏„Éã„Ç¢Âêë„ÅëË®≠ÂÆöÁ∑®ÈõÜ</summary>
                            <textarea class="config-editor" id="configEditor" placeholder="Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø‰∏≠..."></textarea>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-secondary" onclick="loadConfig()">üì• JSONË™≠„ÅøËæº„Åø</button>
                                <button class="btn btn-secondary" onclick="saveConfig()">üíæ JSON‰øùÂ≠ò</button>
                            </div>
                        </details>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <div class="status status-warning">
                            <span>‚ö†Ô∏è</span>
                            <span>Ë®≠ÂÆöÂ§âÊõ¥Âæå„ÅØ„Çµ„Éº„Éê„Éº„ÅÆÂÜçËµ∑Âãï„ÅåÂøÖË¶Å„Åß„Åô</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- „É≠„Ç∞Èñ≤Ë¶ßÁîªÈù¢ -->
            <div class="app-content" id="logs-content">
                <div class="logs-panel">
                    <h3>üìã „É≠„Ç∞Èñ≤Ë¶ß</h3>
                    <p>„Ç∑„Çπ„ÉÜ„É†„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„ÅüÈÅéÂéª„ÅÆ„É≠„Ç∞„ÇíÈñ≤Ë¶ß„ÉªÊ§úÁ¥¢„Åß„Åç„Åæ„Åô„ÄÇ</p>
                    
                    <!-- „É≠„Ç∞„Éï„Ç°„Ç§„É´ÈÅ∏Êäû -->
                    <div class="log-selection">
                        <h4>üìÅ „É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ß</h4>
                        <div class="log-controls">
                            <button class="btn" onclick="loadLogFiles()">üîÑ „É™„Çπ„ÉàÊõ¥Êñ∞</button>
                            <button class="btn btn-secondary" onclick="loadAllLogs()">üìö ÂÖ®„É≠„Ç∞‰∏ÄÊã¨Ë°®Á§∫</button>
                            <select id="logFileSelect" class="form-control" onchange="loadSelectedLog()">
                                <option value="">ÂÄãÂà•„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Ê§úÁ¥¢„Éï„Ç£„É´„Çø„Éº -->
                    <div class="log-search">
                        <h4>üîç Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº</h4>
                        <div class="search-controls">
                            <input type="text" id="logSearchInput" class="form-control" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ...">
                            <button class="btn" onclick="addKeywordFilter()">‚ûï ËøΩÂä†</button>
                            <button class="btn btn-secondary" onclick="clearAllKeywords()">üóëÔ∏è ÂÖ®„ÇØ„É™„Ç¢</button>
                            <span id="searchResultCount" class="search-count">0‰ª∂</span>
                        </div>
                        <div id="keywordTags" class="keyword-tags"></div>
                    </div>
                    
                    <!-- „É≠„Ç∞ÂÜÖÂÆπË°®Á§∫ -->
                    <div class="log-content">
                        <h4>üìÑ „É≠„Ç∞ÂÜÖÂÆπ</h4>
                        <div id="logDisplay" class="log-display">
                            „É≠„Ç∞„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÂãïÁöÑ„Ç¢„Éó„É™„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„Åì„Åì„Å´ËøΩÂä†„Åï„Çå„Çã -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
                <div class="money-panel">
                    <h3>üí∞ „ÅäÈáëÁÆ°ÁêÜ</h3>
                    
                    <!-- ÂèéÊîØÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                    <div class="input-section">
                        <h4>üìù ÂèéÊîØË®òÈå≤</h4>
                        <div class="input-form">
                            <div class="form-row">
                                <select id="money-type" class="form-control">
                                    <option value="income">ÂèéÂÖ•</option>
                                    <option value="expense">ÊîØÂá∫</option>
                                </select>
                                <input type="number" id="money-amount" class="form-control" placeholder="ÈáëÈ°ç" min="0">
                            </div>
                            <div class="form-row">
                                <select id="money-category" class="form-control">
                                    <option value="Áµ¶‰∏é">Áµ¶‰∏é</option>
                                    <option value="ÂâØÊ•≠">ÂâØÊ•≠</option>
                                    <option value="„Éú„Éº„Éä„Çπ">„Éú„Éº„Éä„Çπ</option>
                                    <option value="È£üË≤ª">È£üË≤ª</option>
                                    <option value="‰∫§ÈÄöË≤ª">‰∫§ÈÄöË≤ª</option>
                                    <option value="Â®ØÊ•ΩË≤ª">Â®ØÊ•ΩË≤ª</option>
                                    <option value="ÂÖâÁÜ±Ë≤ª">ÂÖâÁÜ±Ë≤ª</option>
                                    <option value="ÂÆ∂Ë≥É">ÂÆ∂Ë≥É</option>
                                    <option value="„Åù„ÅÆ‰ªñ">„Åù„ÅÆ‰ªñ</option>
                                </select>
                                <input type="text" id="money-description" class="form-control" placeholder="Ë™¨ÊòéÔºà‰ªªÊÑèÔºâ">
                            </div>
                            <div class="form-row">
                                <input type="date" id="money-date" class="form-control">
                                <button class="btn" onclick="addMoneyTransaction()">üíæ Ë®òÈå≤</button>
                                <button class="btn btn-secondary" onclick="exportMoneyCSV()">üì• CSVÂá∫Âäõ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂèñÂºï‰∏ÄË¶ß -->
                    <div class="transaction-list">
                        <h4>üìä ÂèñÂºïÂ±•Ê≠¥</h4>
                        <div id="money-transactions" class="transactions-display">
                            „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÊôÇÈñìÁÆ°ÁêÜÁîªÈù¢ -->
            <div class="app-content" id="time-content" style="display: none;">
                <div class="time-panel">
                    <h3>‚è∞ ÊôÇÈñìÁÆ°ÁêÜ</h3>
                    
                    <!-- ÊôÇÈñìË®òÈå≤„Éï„Ç©„Éº„É† -->
                    <div class="input-section">
                        <h4>üìù ÊôÇÈñìË®òÈå≤</h4>
                        <div class="input-form">
                            <div class="form-row">
                                <input type="text" id="time-task" class="form-control" placeholder="„Çø„Çπ„ÇØÂêç">
                                <select id="time-category" class="form-control">
                                    <option value="‰ªï‰∫ã">‰ªï‰∫ã</option>
                                    <option value="ÂãâÂº∑">ÂãâÂº∑</option>
                                    <option value="ÈÅãÂãï">ÈÅãÂãï</option>
                                    <option value="‰ºëÊÜ©">‰ºëÊÜ©</option>
                                    <option value="„Åù„ÅÆ‰ªñ">„Åù„ÅÆ‰ªñ</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <input type="number" id="time-hours" class="form-control" placeholder="ÊôÇÈñì" min="0" max="24">
                                <input type="number" id="time-minutes" class="form-control" placeholder="ÂàÜ" min="0" max="59">
                                <input type="date" id="time-date" class="form-control">
                            </div>
                            <div class="form-row">
                                <button class="btn" onclick="addTimeRecord()">üíæ Ë®òÈå≤</button>
                                <button class="btn btn-secondary" onclick="exportTimeCSV()">üì• CSVÂá∫Âäõ</button>
                                <button class="btn btn-warning" onclick="startTimer()">‚è±Ô∏è „Çø„Ç§„Éû„ÉºÈñãÂßã</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- „Çø„Ç§„Éû„ÉºË°®Á§∫ -->
                    <div class="timer-section" id="timer-section" style="display: none;">
                        <h4>‚è±Ô∏è „Çø„Ç§„Éû„Éº</h4>
                        <div class="timer-display">
                            <div id="timer-display" class="timer-clock">00:00:00</div>
                            <div class="timer-controls">
                                <button class="btn" onclick="pauseTimer()">‚è∏Ô∏è ‰∏ÄÊôÇÂÅúÊ≠¢</button>
                                <button class="btn btn-danger" onclick="stopTimer()">‚èπÔ∏è ÂÅúÊ≠¢</button>
                            </div>
                            <div id="timer-task-name" class="timer-task"></div>
                        </div>
                    </div>
                    
                    <!-- ÊôÇÈñìË®òÈå≤‰∏ÄË¶ß -->
                    <div class="time-list">
                        <h4>üìä ÊôÇÈñìË®òÈå≤Â±•Ê≠¥</h4>
                        <div id="time-records" class="records-display">
                            „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ‰ΩìÈáçÁÆ°ÁêÜÁîªÈù¢ -->
            <div class="app-content" id="weight-content" style="display: none;">
                <div class="weight-panel">
                    <h3>‚öñÔ∏è ‰ΩìÈáçÁÆ°ÁêÜ</h3>
                    
                    <!-- ‰ΩìÈáçË®òÈå≤„Éï„Ç©„Éº„É† -->
                    <div class="input-section">
                        <h4>üìù ‰ΩìÈáçË®òÈå≤</h4>
                        <div class="input-form">
                            <div class="form-row">
                                <input type="number" id="weight-value" class="form-control" placeholder="‰ΩìÈáç (kg)" step="0.1" min="20" max="300">
                                <input type="number" id="weight-height" class="form-control" placeholder="Ë∫´Èï∑ (cm)" min="100" max="250">
                                <input type="date" id="weight-date" class="form-control">
                            </div>
                            <div class="form-row">
                                <textarea id="weight-memo" class="form-control" placeholder="„É°„É¢Ôºà‰ΩìË™ø„ÉªÈ£ü‰∫ã„Å™„Å©Ôºâ" rows="2"></textarea>
                            </div>
                            <div class="form-row">
                                <button class="btn" onclick="addWeightRecord()">üíæ Ë®òÈå≤</button>
                                <button class="btn btn-secondary" onclick="exportWeightCSV()">üì• CSVÂá∫Âäõ</button>
                                <button class="btn btn-warning" onclick="calculateBMI()">üìä BMIË®àÁÆó</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- BMIË°®Á§∫ -->
                    <div class="bmi-section" id="bmi-section" style="display: none;">
                        <h4>üìä BMIË®àÁÆóÁµêÊûú</h4>
                        <div class="bmi-display">
                            <div id="bmi-result" class="bmi-value"></div>
                            <div id="bmi-status" class="bmi-status"></div>
                        </div>
                    </div>
                    
                    <!-- ‰ΩìÈáçË®òÈå≤‰∏ÄË¶ß -->
                    <div class="weight-list">
                        <h4>üìä ‰ΩìÈáçË®òÈå≤Â±•Ê≠¥</h4>
                        <div id="weight-records" class="records-display">
                            „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- „É°„É¢ÁÆ°ÁêÜÁîªÈù¢ -->
            <div class="app-content" id="memo-content" style="display: none;">
                <div class="memo-panel">
                    <h3>üìù „É°„É¢ÁÆ°ÁêÜ</h3>
                    
                    <!-- „É°„É¢‰ΩúÊàê„Éï„Ç©„Éº„É† -->
                    <div class="input-section">
                        <h4>üìù „É°„É¢‰ΩúÊàê</h4>
                        <div class="input-form">
                            <div class="form-row">
                                <input type="text" id="memo-title" class="form-control" placeholder="„Çø„Ç§„Éà„É´">
                                <select id="memo-category" class="form-control">
                                    <option value="‰ªï‰∫ã">‰ªï‰∫ã</option>
                                    <option value="„Éó„É©„Ç§„Éô„Éº„Éà">„Éó„É©„Ç§„Éô„Éº„Éà</option>
                                    <option value="Â≠¶Áøí">Â≠¶Áøí</option>
                                    <option value="„Ç¢„Ç§„Éá„Ç¢">„Ç¢„Ç§„Éá„Ç¢</option>
                                    <option value="„Åù„ÅÆ‰ªñ">„Åù„ÅÆ‰ªñ</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <textarea id="memo-textarea" class="form-control" placeholder="„É°„É¢ÂÜÖÂÆπ" rows="4"></textarea>
                            </div>
                            <div class="form-row">
                                <input type="text" id="memo-tags" class="form-control" placeholder="„Çø„Ç∞Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ">
                                <button class="btn" onclick="addMemo()">üíæ ‰øùÂ≠ò</button>
                                <button class="btn btn-secondary" onclick="exportMemoCSV()">üì• CSVÂá∫Âäõ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- „Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ -->
                    <div class="memo-filter-section">
                        <h4>üîç „Éï„Ç£„É´„Çø„Éº</h4>
                        <div class="filter-input-section">
                            <div class="form-row">
                                <input type="text" id="memo-filter-input" class="form-control" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ">
                                <button class="btn btn-secondary" onclick="addFilterKeyword()">Ôºã ËøΩÂä†</button>
                                <button class="btn btn-warning" onclick="clearAllFilters()">üóëÔ∏è ÂÖ®„ÇØ„É™„Ç¢</button>
                            </div>
                        </div>
                        <div id="filter-keywords" class="filter-keywords">
                            <!-- ËøΩÂä†„Åï„Çå„Åü„Ç≠„Éº„ÉØ„Éº„Éâ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                        </div>
                    </div>

                    <!-- „É°„É¢‰∏ÄË¶ß -->
                    <div class="memo-list">
                        <h4>üìä „É°„É¢‰∏ÄË¶ß</h4>
                        <div id="memo-records" class="memo-display">
                            „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ë®àÁÆóÊ©üÁîªÈù¢ -->
            <div class="app-content" id="calc-content" style="display: none;">
                <div class="calc-panel">
                    <h3>üßÆ Ë®àÁÆóÊ©ü</h3>
                    
                    <!-- Ë®àÁÆóÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                    <div class="input-section">
                        <h4>üßÆ Êï∞ÂÄ§Ë®àÁÆó</h4>
                        <div class="calc-form">
                            <div class="calc-input-row">
                                <input type="number" id="calc-number-a" class="form-control calc-input" placeholder="Êï∞ÂÄ§A" step="any">
                                <span class="calc-operator">+</span>
                                <input type="number" id="calc-number-b" class="form-control calc-input" placeholder="Êï∞ÂÄ§B" step="any">
                                <span class="calc-equals">=</span>
                                <span id="calc-result" class="calc-result">?</span>
                            </div>
                            <div class="calc-button-row">
                                <button class="btn calc-btn" onclick="calculateNumbers()">üßÆ Ë®àÁÆóÂÆüË°å</button>
                                <button class="btn btn-secondary" onclick="clearCalculation()">üóëÔ∏è „ÇØ„É™„Ç¢</button>
                                <button class="btn btn-secondary" onclick="exportCalcCSV()">üì• Â±•Ê≠¥CSVÂá∫Âäõ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ë®àÁÆóÂ±•Ê≠¥ -->
                    <div class="calc-history-section">
                        <h4>üìä Ë®àÁÆóÂ±•Ê≠¥</h4>
                        <div id="calc-history-list" class="calc-history-list">
                            <div class="loading">Â±•Ê≠¥„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- „É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="log-section">
            <h3>üìä „Ç∑„Çπ„ÉÜ„É†„É≠„Ç∞</h3>
            <div class="log-controls">
                <button class="btn" onclick="downloadLogs()">üì• „É≠„Ç∞„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                <button class="btn btn-secondary" onclick="copyLogsToClipboard()">üìã „ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Ç≥„Éî„Éº</button>
                <button class="btn" onclick="clearLogs()">üóëÔ∏è „É≠„Ç∞„ÇØ„É™„Ç¢</button>
                <button class="btn" onclick="refreshLogs()">üîÑ „É≠„Ç∞Êõ¥Êñ∞</button>
            </div>
            <div class="debug-logs" id="debugLogs">„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ‰∏≠...</div>
        </div>
    </div>

    <script>
        // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇØ„É©„Çπ
        class SmartTemplateApp {
            constructor() {
                this.currentUser = null;
                this.currentApp = 'welcome';
                this.config = null;
                this.loadedApps = [];
                this.logs = [];
                
                // „Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ„Éó„É≠„Éë„ÉÜ„Ç£
                this.filterKeywords = [];
                this.maxFilterKeywords = 5;
                
                this.setupEventListeners();
                this.initialize();
                
                this.log('üöÄ Áµ±Âêà„Ç¢„Éó„É™ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É† v1.0 ÂàùÊúüÂåñÂÆå‰∫Ü');
            }

            async initialize() {
                try {
                    // FirebaseË®≠ÂÆöË™≠„ÅøËæº„Åø
                    await this.loadFirebaseConfig();
                    
                    // „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±Ë™≠„ÅøËæº„Åø
                    await this.loadSystemInfo();
                    
                    // Ë®≠ÂÆöË™≠„ÅøËæº„Åø
                    await this.loadAppConfig();
                    
                    // Ë™çË®ºË®≠ÂÆö
                    this.setupAuth();
                    
                    this.updateConnectionStatus('success', '„Ç™„É≥„É©„Ç§„É≥');
                    this.log('‚úÖ ÂàùÊúüÂåñÂÆå‰∫Ü');
                    
                } catch (error) {
                    this.updateConnectionStatus('error', 'ÂàùÊúüÂåñ„Ç®„É©„Éº');
                    this.log(`‚ùå ÂàùÊúüÂåñ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // FirebaseË®≠ÂÆöË™≠„ÅøËæº„Åø
            async loadFirebaseConfig() {
                try {
                    const response = await fetch('/api/firebase-config');
                    const firebaseConfig = await response.json();
                    
                    firebase.initializeApp(firebaseConfig);
                    this.auth = firebase.auth();
                    this.database = firebase.database();
                    
                    this.log('üî• FirebaseÂàùÊúüÂåñÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå FirebaseÂàùÊúüÂåñ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±Ë™≠„ÅøËæº„Åø
            async loadSystemInfo() {
                try {
                    const response = await fetch('/api/info');
                    const info = await response.json();
                    
                    document.getElementById('appName').textContent = info.appName;
                    document.getElementById('version').textContent = `v${info.version}`;
                    document.getElementById('uptime').textContent = `${Math.floor(info.uptime / 60)}ÂàÜ`;
                    
                    if (info.moduleLoader) {
                        document.getElementById('enabledApps').textContent = 
                            `${info.moduleLoader.loadedAppsCount}ÂÄã`;
                    }
                    
                    this.log('üìä „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±Ë™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „Ç¢„Éó„É™Ë®≠ÂÆöË™≠„ÅøËæº„Åø
            async loadAppConfig() {
                try {
                    const response = await fetch('/api/config');
                    const data = await response.json();
                    
                    this.config = data.config;
                    this.loadedApps = data.loadedApps || [];
                    
                    this.setupAppTabs();
                    this.log(`üìã Ë®≠ÂÆöË™≠„ÅøËæº„ÅøÂÆå‰∫Ü | ${this.loadedApps.length}ÂÄã„ÅÆ„Ç¢„Éó„É™`);
                } catch (error) {
                    this.log(`‚ùå Ë®≠ÂÆöË™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „Ç¢„Éó„É™„Çø„ÉñË®≠ÂÆö
            setupAppTabs() {
                const tabsContainer = document.getElementById('appTabs');
                
                // Êó¢Â≠ò„ÅÆÂãïÁöÑ„Çø„Éñ„ÇíÂâäÈô§
                const dynamicTabs = tabsContainer.querySelectorAll('.app-tab[data-dynamic="true"]');
                dynamicTabs.forEach(tab => tab.remove());
                
                // „Ç¢„Éó„É™„Çø„Éñ„ÇíËøΩÂä†
                this.loadedApps.forEach(app => {
                    const tab = document.createElement('button');
                    tab.className = 'app-tab';
                    tab.setAttribute('data-app', app.name);
                    tab.setAttribute('data-dynamic', 'true');
                    tab.innerHTML = `
                        <span class="icon">${app.icon}</span>
                        <span>${app.displayName}</span>
                    `;
                    tabsContainer.appendChild(tab);
                    
                    // „Çø„Éñ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
                    tab.addEventListener('click', () => this.switchApp(app.name));
                    
                    // „Ç¢„Éó„É™„Ç≥„É≥„ÉÜ„É≥„ÉÑÈ†òÂüü„Çí‰ΩúÊàê
                    this.createAppContent(app);
                });
            }

            // „Ç¢„Éó„É™„Ç≥„É≥„ÉÜ„É≥„ÉÑ‰ΩúÊàê
            createAppContent(app) {
                const mainContent = document.querySelector('.main-content');
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'app-content';
                contentDiv.id = `${app.name}-content`;
                contentDiv.innerHTML = `
                    <div style="padding: 20px; text-align: center;">
                        <h2>${app.icon} ${app.displayName}</h2>
                        <p>${app.description || '„Ç¢„Éó„É™„ÅåÊ≠£Â∏∏„Å´Ë™≠„ÅøËæº„Åæ„Çå„Åæ„Åó„Åü'}</p>
                        <p><strong>„Éê„Éº„Ç∏„Éß„É≥:</strong> ${app.version}</p>
                        <p><strong>„Çπ„ÉÜ„Éº„Çø„Çπ:</strong> ${app.status}</p>
                        
                        <div style="margin-top: 30px;">
                            <button class="btn" onclick="app.testAppAPI('${app.name}')">
                                üîó ${app.displayName} API „ÉÜ„Çπ„Éà
                            </button>
                        </div>
                        
                        <div style="margin-top: 20px; text-align: left;">
                            <h4>Âà©Áî®ÂèØËÉΩ„Å™API:</h4>
                            <ul style="margin-top: 10px;">
                                <li>GET /api/${app.name}/* - „Éá„Éº„ÇøÂèñÂæó</li>
                                <li>POST /api/${app.name}/* - „Éá„Éº„ÇøËøΩÂä†</li>
                                <li>DELETE /api/${app.name}/* - „Éá„Éº„ÇøÂâäÈô§</li>
                                <li>POST /api/${app.name}/export/csv - CSVÂá∫Âäõ</li>
                            </ul>
                        </div>
                    </div>
                `;
                
                mainContent.appendChild(contentDiv);
            }

            // „Ç¢„Éó„É™Âàá„ÇäÊõø„Åà
            switchApp(appName) {
                // „Çø„Éñ„ÅÆÂàá„ÇäÊõø„Åà
                document.querySelectorAll('.app-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-app="${appName}"]`).classList.add('active');
                
                // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆÂàá„ÇäÊõø„Åà
                document.querySelectorAll('.app-content').forEach(content => {
                    content.style.display = 'none';
                });
                
                const targetContent = document.getElementById(`${appName}-content`);
                if (targetContent) {
                    targetContent.style.display = 'block';
                    
                    // „Ç¢„Éó„É™Âõ∫Êúâ„ÅÆÂàùÊúüÂåñ
                    if (appName === 'money') {
                        // ‰ªäÊó•„ÅÆÊó•‰ªò„Çí„Éá„Éï„Ç©„É´„Éà„Å´Ë®≠ÂÆö
                        const today = new Date().toISOString().split('T')[0];
                        const dateInput = document.getElementById('money-date');
                        if (dateInput) {
                            dateInput.value = today;
                        }
                        
                        // ÂèñÂºïÂ±•Ê≠¥„ÇíË™≠„ÅøËæº„Åø
                        this.loadMoneyTransactions();
                    } else if (appName === 'time') {
                        // ‰ªäÊó•„ÅÆÊó•‰ªò„Çí„Éá„Éï„Ç©„É´„Éà„Å´Ë®≠ÂÆö
                        const today = new Date().toISOString().split('T')[0];
                        const dateInput = document.getElementById('time-date');
                        if (dateInput) {
                            dateInput.value = today;
                        }
                        
                        // ÊôÇÈñìË®òÈå≤„ÇíË™≠„ÅøËæº„Åø
                        this.loadTimeRecords();
                    } else if (appName === 'weight') {
                        // ‰ªäÊó•„ÅÆÊó•‰ªò„Çí„Éá„Éï„Ç©„É´„Éà„Å´Ë®≠ÂÆö
                        const today = new Date().toISOString().split('T')[0];
                        const dateInput = document.getElementById('weight-date');
                        if (dateInput) {
                            dateInput.value = today;
                        }
                        
                        // ‰ΩìÈáçË®òÈå≤„ÇíË™≠„ÅøËæº„Åø
                        this.loadWeightRecords();
                    } else if (appName === 'memo') {
                        // „Éï„Ç£„É´„Çø„ÉºË°®Á§∫„ÇíÂàùÊúüÂåñ
                        this.updateFilterKeywordsDisplay();
                        // „É°„É¢‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„Åø
                        this.loadMemos();
                    } else if (appName === 'calc') {
                        // Ë®àÁÆóÂ±•Ê≠¥„ÇíË™≠„ÅøËæº„Åø
                        this.loadCalcHistory();
                    }
                    
                    // Ë®≠ÂÆöÁîªÈù¢„ÅÆÂ†¥Âêà„ÅØË®≠ÂÆöUI„ÇíÂàùÊúüÂåñ
                    if (appName === 'settings') {
                        this.loadConfigUI();
                    }
                }
                
                this.currentApp = appName;
                this.log(`üîÑ „Ç¢„Éó„É™Âàá„ÇäÊõø„Åà | ${appName}`);
            }

            // Ë™çË®ºË®≠ÂÆö
            setupAuth() {
                if (!this.auth) return;
                
                this.auth.onAuthStateChanged((user) => {
                    this.currentUser = user;
                    this.updateAuthUI();
                    
                    if (user) {
                        this.log(`üë§ „É≠„Ç∞„Ç§„É≥ÊàêÂäü | ${user.email}`);
                    } else {
                        this.log('üë§ „É≠„Ç∞„Ç¢„Ç¶„Éà');
                    }
                });
            }

            // Ë™çË®ºUIÊõ¥Êñ∞
            updateAuthUI() {
                const authBtn = document.getElementById('authBtn');
                
                if (this.currentUser) {
                    authBtn.textContent = '„É≠„Ç∞„Ç¢„Ç¶„Éà';
                    authBtn.onclick = () => this.signOut();
                } else {
                    authBtn.textContent = 'Google„Åß„É≠„Ç∞„Ç§„É≥';
                    authBtn.onclick = () => this.signIn();
                }
            }

            // „É≠„Ç∞„Ç§„É≥
            async signIn() {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    await this.auth.signInWithPopup(provider);
                } catch (error) {
                    this.log(`‚ùå „É≠„Ç∞„Ç§„É≥„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „É≠„Ç∞„Ç¢„Ç¶„Éà
            async signOut() {
                try {
                    await this.auth.signOut();
                } catch (error) {
                    this.log(`‚ùå „É≠„Ç∞„Ç¢„Ç¶„Éà„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // Êé•Á∂ö„Çπ„ÉÜ„Éº„Çø„ÇπÊõ¥Êñ∞
            updateConnectionStatus(type, message) {
                const status = document.getElementById('connectionStatus');
                status.className = `status status-${type}`;
                status.innerHTML = `<span>${type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ùå'}</span><span>${message}</span>`;
            }

            // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
            setupEventListeners() {
                // „Çø„ÉñÂàá„ÇäÊõø„Åà
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.app-tab')) {
                        const tab = e.target.closest('.app-tab');
                        const appName = tab.getAttribute('data-app');
                        this.switchApp(appName);
                    }
                });
                
                // „Éï„Ç£„É´„Çø„ÉºÂÖ•Âäõ„ÅßEnter„Ç≠„ÉºÊäº‰∏ãÊôÇ„Å´ËøΩÂä†
                document.addEventListener('keypress', (e) => {
                    if (e.target.id === 'memo-filter-input' && e.key === 'Enter') {
                        e.preventDefault();
                        this.addFilterKeyword();
                    }
                });
            }

            // API „ÉÜ„Çπ„Éà
            async testAPI() {
                try {
                    this.log('üîó APIÊé•Á∂ö„ÉÜ„Çπ„ÉàÈñãÂßã');
                    
                    const response = await fetch('/api/health');
                    const data = await response.json();
                    
                    if (data.status === 'OK') {
                        this.log('‚úÖ APIÊé•Á∂ö„ÉÜ„Çπ„ÉàÊàêÂäü');
                        this.updateConnectionStatus('success', 'APIÊ≠£Â∏∏');
                    } else {
                        this.log('‚ùå APIÊé•Á∂ö„ÉÜ„Çπ„ÉàÂ§±Êïó');
                        this.updateConnectionStatus('error', 'APIÁï∞Â∏∏');
                    }
                } catch (error) {
                    this.log(`‚ùå APIÊé•Á∂ö„ÉÜ„Çπ„Éà„Ç®„É©„Éº | ${error.message}`);
                    this.updateConnectionStatus('error', 'APIÊé•Á∂ö„Ç®„É©„Éº');
                }
            }

            // „Ç¢„Éó„É™ÂÄãÂà•API „ÉÜ„Çπ„Éà
            async testAppAPI(appName) {
                try {
                    this.log(`üîó ${appName} API „ÉÜ„Çπ„ÉàÈñãÂßã`);
                    
                    // „Ç¢„Éó„É™Âõ∫Êúâ„ÅÆ„ÉÜ„Çπ„ÉàAPI„ÇíÂëº„Å≥Âá∫„Åó
                    const response = await fetch(`/api/${appName}/sample-data`, {
                        method: 'POST'
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.log(`‚úÖ ${appName} API „ÉÜ„Çπ„ÉàÊàêÂäü`);
                    } else {
                        this.log(`‚ùå ${appName} API „ÉÜ„Çπ„ÉàÂ§±Êïó`);
                    }
                } catch (error) {
                    this.log(`‚ùå ${appName} API „ÉÜ„Çπ„Éà„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàê
            async generateSampleData() {
                try {
                    this.log('üéØ „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàêÈñãÂßã');
                    
                    for (const app of this.loadedApps) {
                        await this.testAppAPI(app.name);
                    }
                    
                    this.log('‚úÖ ÂÖ®„Ç¢„Éó„É™„ÅÆ„Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàêÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàê„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // Ë®≠ÂÆöÈñ¢ÈÄ£Ê©üËÉΩ
            async loadConfig() {
                try {
                    const response = await fetch('/api/config');
                    const data = await response.json();
                    
                    document.getElementById('configEditor').value = 
                        JSON.stringify(data.config, null, 2);
                    
                    this.log('üì• Ë®≠ÂÆöË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå Ë®≠ÂÆöË™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async saveConfig() {
                try {
                    const configText = document.getElementById('configEditor').value;
                    const config = JSON.parse(configText);
                    
                    const response = await fetch('/api/config', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(config)
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.log('üíæ Ë®≠ÂÆö‰øùÂ≠òÂÆå‰∫Ü');
                        alert('Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü„ÄÇÂ§âÊõ¥„ÇíÂèçÊò†„Åô„Çã„Å´„ÅØ„Çµ„Éº„Éê„Éº„ÇíÂÜçËµ∑Âãï„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    } else {
                        throw new Error(data.error || 'Ë®≠ÂÆö‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå Ë®≠ÂÆö‰øùÂ≠ò„Ç®„É©„Éº | ${error.message}`);
                    alert(`Ë®≠ÂÆö‰øùÂ≠ò„Ç®„É©„Éº: ${error.message}`);
                }
            }

            async resetConfig() {
                if (confirm('Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü')) {
                    await this.loadConfig();
                    this.log('üîÑ Ë®≠ÂÆö„É™„Çª„ÉÉ„ÉàÂÆå‰∫Ü');
                }
            }

            // „ÅäÈáëÁÆ°ÁêÜÊ©üËÉΩ
            async addMoneyTransaction() {
                const type = document.getElementById('money-type').value;
                const amount = parseFloat(document.getElementById('money-amount').value);
                const category = document.getElementById('money-category').value;
                const description = document.getElementById('money-description').value;
                const date = document.getElementById('money-date').value || new Date().toISOString().split('T')[0];

                if (!amount || amount <= 0) {
                    alert('Ê≠£„Åó„ÅÑÈáëÈ°ç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const transaction = {
                    id: Date.now().toString(),
                    type,
                    amount,
                    category,
                    description,
                    date,
                    timestamp: new Date().toISOString(),
                    userId: this.currentUser ? this.currentUser.uid : 'anonymous'
                };

                try {
                    // Firebase Realtime Database„Å´‰øùÂ≠ò
                    if (this.database && this.currentUser) {
                        await this.database.ref(`transactions/${this.currentUser.uid}/${transaction.id}`).set(transaction);
                        this.log(`üí∞ ÂèñÂºï„ÇíFirebase„Å´‰øùÂ≠ò | ${type} ${amount}ÂÜÜ`);
                    }

                    // „É≠„Éº„Ç´„É´„Å´„ÇÇ‰øùÂ≠ò
                    this.saveTransactionLocal(transaction);
                    
                    // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                    document.getElementById('money-amount').value = '';
                    document.getElementById('money-description').value = '';
                    
                    // ÂèñÂºï‰∏ÄË¶ß„ÇíÊõ¥Êñ∞
                    this.loadMoneyTransactions();
                    
                    this.log(`üí∞ ÂèñÂºïË®òÈå≤ÂÆå‰∫Ü | ${type} ${amount}ÂÜÜ (${category})`);
                } catch (error) {
                    this.log(`‚ùå ÂèñÂºï‰øùÂ≠ò„Ç®„É©„Éº | ${error.message}`);
                }
            }

            saveTransactionLocal(transaction) {
                let transactions = JSON.parse(localStorage.getItem('moneyTransactions') || '[]');
                transactions.push(transaction);
                localStorage.setItem('moneyTransactions', JSON.stringify(transactions));
            }

            async loadMoneyTransactions() {
                try {
                    let transactions = [];
                    
                    // Firebase „Åã„ÇâÂèñÂæó
                    if (this.database && this.currentUser) {
                        const snapshot = await this.database.ref(`transactions/${this.currentUser.uid}`).once('value');
                        if (snapshot.exists()) {
                            transactions = Object.values(snapshot.val());
                        }
                    }
                    
                    // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„Çâ„ÇÇÂèñÂæóÔºà„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÔºâ
                    const localTransactions = JSON.parse(localStorage.getItem('moneyTransactions') || '[]');
                    
                    // „Éû„Éº„Ç∏ÔºàÈáçË§áÈô§ÂéªÔºâ
                    const allTransactions = [...transactions, ...localTransactions];
                    const uniqueTransactions = allTransactions.filter((trans, index, self) =>
                        index === self.findIndex(t => t.id === trans.id)
                    );
                    
                    // Êó•‰ªòÈ†Ü„Åß„ÇΩ„Éº„Éà
                    uniqueTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    this.displayTransactions(uniqueTransactions);
                } catch (error) {
                    this.log(`‚ùå ÂèñÂºïË™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            displayTransactions(transactions) {
                const container = document.getElementById('money-transactions');
                
                if (transactions.length === 0) {
                    container.innerHTML = '<p>ÂèñÂºïÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                    return;
                }
                
                let html = '';
                let totalIncome = 0;
                let totalExpense = 0;
                
                transactions.forEach(trans => {
                    const isIncome = trans.type === 'income';
                    const amount = parseFloat(trans.amount);
                    
                    if (isIncome) {
                        totalIncome += amount;
                    } else {
                        totalExpense += amount;
                    }
                    
                    html += `
                        <div class="transaction-item ${isIncome ? 'transaction-income' : 'transaction-expense'}">
                            <div>
                                <strong>${trans.date}</strong> | ${trans.category}
                                ${trans.description ? ` - ${trans.description}` : ''}
                            </div>
                            <div>
                                <span style="color: ${isIncome ? 'green' : 'red'}">
                                    ${isIncome ? '+' : '-'}${amount.toLocaleString()}ÂÜÜ
                                </span>
                            </div>
                        </div>
                    `;
                });
                
                const balance = totalIncome - totalExpense;
                html = `
                    <div style="background: #e9ecef; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                        <strong>ÊÆãÈ´ò: ${balance.toLocaleString()}ÂÜÜ</strong> 
                        (ÂèéÂÖ•: ${totalIncome.toLocaleString()}ÂÜÜ, ÊîØÂá∫: ${totalExpense.toLocaleString()}ÂÜÜ)
                    </div>
                ` + html;
                
                container.innerHTML = html;
            }

            async exportMoneyCSV() {
                try {
                    const response = await fetch('/api/money/export/csv', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            startDate: null,
                            endDate: null,
                            type: null
                        })
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `money_transactions_${new Date().toISOString().split('T')[0]}.csv`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                        
                        this.log('üì• CSVÂá∫ÂäõÂÆå‰∫Ü');
                    }
                } catch (error) {
                    this.log(`‚ùå CSVÂá∫Âäõ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „É≠„Ç∞„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Ç≥„Éî„ÉºÊ©üËÉΩ
            async copyLogsToClipboard() {
                try {
                    const logContainer = document.getElementById('debugLogs');
                    const logText = logContainer.textContent || logContainer.innerText;
                    
                    // „É≠„Ç∞„ÅåÁ©∫„ÅÆÂ†¥Âêà
                    if (!logText || logText === '„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ‰∏≠...') {
                        this.log('‚ùå „Ç≥„Éî„ÉºÂèØËÉΩ„Å™„É≠„Ç∞„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                        alert('„Ç≥„Éî„ÉºÂèØËÉΩ„Å™„É≠„Ç∞„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                        return;
                    }
                    
                    // „ÇØ„É™„ÉÉ„Éó„Éú„Éº„ÉâAPIÂØæÂøú„ÉÅ„Çß„ÉÉ„ÇØ
                    if (navigator.clipboard && window.isSecureContext) {
                        await navigator.clipboard.writeText(logText);
                        this.log('üìã „É≠„Ç∞„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„ÉºÂÆå‰∫Ü');
                        
                        // ÊàêÂäü„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
                        const button = document.querySelector('[onclick="copyLogsToClipboard()"]');
                        const originalText = button.textContent;
                        button.textContent = '‚úÖ „Ç≥„Éî„ÉºÂÆå‰∫Ü';
                        button.style.background = '#4CAF50';
                        
                        setTimeout(() => {
                            button.textContent = originalText;
                            button.style.background = '';
                        }, 2000);
                        
                    } else {
                        // Âè§„ÅÑ„Éñ„É©„Ç¶„Ç∂Áî®„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
                        const textArea = document.createElement('textarea');
                        textArea.value = logText;
                        textArea.style.position = 'fixed';
                        textArea.style.opacity = '0';
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        
                        this.log('üìã „É≠„Ç∞„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„ÉºÂÆå‰∫ÜÔºà„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºâ');
                        alert('„É≠„Ç∞„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü');
                    }
                    
                } catch (error) {
                    this.log(`‚ùå „ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Ç≥„Éî„Éº„Ç®„É©„Éº | ${error.message}`);
                    alert('„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å∏„ÅÆ„Ç≥„Éî„Éº„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            }

            // ÊôÇÈñìÁÆ°ÁêÜÊ©üËÉΩ
            timer = {
                interval: null,
                seconds: 0,
                isRunning: false,
                taskName: ''
            };

            async addTimeRecord() {
                this.log('‚è∞ ÊôÇÈñìË®òÈå≤„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const task = document.getElementById('time-task').value;
                const category = document.getElementById('time-category').value;
                const hours = parseInt(document.getElementById('time-hours').value) || 0;
                const minutes = parseInt(document.getElementById('time-minutes').value) || 0;
                const date = document.getElementById('time-date').value || new Date().toISOString().split('T')[0];

                if (!task) {
                    this.log('‚ùå „Çø„Çπ„ÇØÂêç„ÅåÂÖ•Âäõ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                    alert('„Çø„Çπ„ÇØÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                if (hours === 0 && minutes === 0) {
                    this.log('‚ùå ÊôÇÈñì„ÅåÂÖ•Âäõ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                    alert('ÊôÇÈñì„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const timeRecord = {
                    id: Date.now().toString(),
                    task,
                    category,
                    hours,
                    minutes,
                    totalMinutes: hours * 60 + minutes,
                    date,
                    timestamp: new Date().toISOString(),
                    userId: this.currentUser ? this.currentUser.uid : 'anonymous'
                };

                try {
                    const response = await fetch('/api/time/add', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(timeRecord)
                    });

                    if (response.ok) {
                        // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                        document.getElementById('time-task').value = '';
                        document.getElementById('time-hours').value = '';
                        document.getElementById('time-minutes').value = '';
                        
                        this.loadTimeRecords();
                        this.log(`‚è∞ ÊôÇÈñìË®òÈå≤ÂÆå‰∫Ü | ${task} ${hours}ÊôÇÈñì${minutes}ÂàÜ (${category})`);
                    } else {
                        this.log('‚ùå ÊôÇÈñìË®òÈå≤„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå ÊôÇÈñìË®òÈå≤„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async loadTimeRecords() {
                this.log('‚è∞ ÊôÇÈñìË®òÈå≤„ÇíË™≠„ÅøËæº„Åø‰∏≠...');
                
                try {
                    const response = await fetch('/api/time/data');
                    const result = await response.json();
                    
                    const container = document.getElementById('time-records');
                    
                    if (result.data && result.data.length === 0) {
                        container.innerHTML = '<p>ÊôÇÈñìË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                        return;
                    }
                    
                    let html = '';
                    let totalMinutes = 0;
                    
                    if (result.data) {
                        result.data.forEach(record => {
                            totalMinutes += record.totalMinutes || 0;
                            
                            html += `
                                <div class="record-item record-${record.category.toLowerCase()}">
                                    <div>
                                        <strong>${record.date}</strong> | ${record.task}
                                        <br><small>${record.category}</small>
                                    </div>
                                    <div>
                                        <span>${record.hours || 0}ÊôÇÈñì${record.minutes || 0}ÂàÜ</span>
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    const totalHours = Math.floor(totalMinutes / 60);
                    const remainingMinutes = totalMinutes % 60;
                    
                    html = `
                        <div style="background: #e9ecef; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                            <strong>ÂêàË®àÊôÇÈñì: ${totalHours}ÊôÇÈñì${remainingMinutes}ÂàÜ</strong>
                        </div>
                    ` + html;
                    
                    container.innerHTML = html || '<p>ÊôÇÈñìË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                    this.log('‚è∞ ÊôÇÈñìË®òÈå≤„ÅÆË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå ÊôÇÈñìË®òÈå≤Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                    document.getElementById('time-records').innerHTML = '<p>ÊôÇÈñìË®òÈå≤„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
                }
            }

            startTimer() {
                this.log('‚è±Ô∏è „Çø„Ç§„Éû„ÉºÈñãÂßã„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const task = document.getElementById('time-task').value;
                if (!task) {
                    this.log('‚ùå „Çø„Ç§„Éû„ÉºÈñãÂßã: „Çø„Çπ„ÇØÂêç„ÅåÂøÖË¶Å„Åß„Åô');
                    alert('„Çø„Çπ„ÇØÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åã„Çâ„Çø„Ç§„Éû„Éº„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                this.timer.taskName = task;
                this.timer.seconds = 0;
                this.timer.isRunning = true;
                
                document.getElementById('timer-section').style.display = 'block';
                document.getElementById('timer-task-name').textContent = `ÂÆüË°å‰∏≠: ${task}`;
                
                this.timer.interval = setInterval(() => {
                    this.timer.seconds++;
                    this.updateTimerDisplay();
                }, 1000);
                
                this.log(`‚è±Ô∏è „Çø„Ç§„Éû„ÉºÈñãÂßã | „Çø„Çπ„ÇØ: ${task}`);
            }

            pauseTimer() {
                this.log('‚è∏Ô∏è „Çø„Ç§„Éû„Éº‰∏ÄÊôÇÂÅúÊ≠¢');
                
                if (this.timer.interval) {
                    clearInterval(this.timer.interval);
                    this.timer.interval = null;
                    this.timer.isRunning = false;
                }
            }

            stopTimer() {
                this.log('‚èπÔ∏è „Çø„Ç§„Éû„ÉºÂÅúÊ≠¢');
                
                if (this.timer.interval) {
                    clearInterval(this.timer.interval);
                    this.timer.interval = null;
                }
                
                const hours = Math.floor(this.timer.seconds / 3600);
                const minutes = Math.floor((this.timer.seconds % 3600) / 60);
                
                // Ëá™Âãï„ÅßÊôÇÈñì„ÇíÂÖ•Âäõ„Éï„Ç©„Éº„É†„Å´Ë®≠ÂÆö
                document.getElementById('time-hours').value = hours;
                document.getElementById('time-minutes').value = minutes;
                
                document.getElementById('timer-section').style.display = 'none';
                this.timer.seconds = 0;
                this.timer.isRunning = false;
                
                this.log(`‚èπÔ∏è „Çø„Ç§„Éû„ÉºÂÅúÊ≠¢ | ÁµåÈÅéÊôÇÈñì: ${hours}ÊôÇÈñì${minutes}ÂàÜ`);
            }

            updateTimerDisplay() {
                const hours = Math.floor(this.timer.seconds / 3600);
                const minutes = Math.floor((this.timer.seconds % 3600) / 60);
                const seconds = this.timer.seconds % 60;
                
                const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('timer-display').textContent = display;
            }

            async exportTimeCSV() {
                this.log('üì• ÊôÇÈñìÁÆ°ÁêÜCSVÂá∫Âäõ„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                try {
                    const response = await fetch('/api/time/export/csv', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `time_records_${new Date().toISOString().split('T')[0]}.csv`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                        
                        this.log('üì• ÊôÇÈñìÁÆ°ÁêÜCSVÂá∫ÂäõÂÆå‰∫Ü');
                    } else {
                        this.log('‚ùå ÊôÇÈñìÁÆ°ÁêÜCSVÂá∫Âäõ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå ÊôÇÈñìÁÆ°ÁêÜCSVÂá∫Âäõ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // ‰ΩìÈáçÁÆ°ÁêÜÊ©üËÉΩ
            async addWeightRecord() {
                this.log('‚öñÔ∏è ‰ΩìÈáçË®òÈå≤„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const weight = parseFloat(document.getElementById('weight-value').value);
                const height = parseFloat(document.getElementById('weight-height').value);
                const date = document.getElementById('weight-date').value || new Date().toISOString().split('T')[0];
                const memo = document.getElementById('weight-memo').value;

                if (!weight) {
                    this.log('‚ùå ‰ΩìÈáç„ÅåÂÖ•Âäõ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                    alert('‰ΩìÈáç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const weightRecord = {
                    id: Date.now().toString(),
                    weight,
                    height,
                    date,
                    memo,
                    timestamp: new Date().toISOString(),
                    userId: this.currentUser ? this.currentUser.uid : 'anonymous'
                };

                // BMIË®àÁÆó
                if (height) {
                    weightRecord.bmi = (weight / Math.pow(height / 100, 2)).toFixed(1);
                }

                try {
                    const response = await fetch('/api/weight/add', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(weightRecord)
                    });

                    if (response.ok) {
                        // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                        document.getElementById('weight-value').value = '';
                        document.getElementById('weight-memo').value = '';
                        
                        this.loadWeightRecords();
                        this.log(`‚öñÔ∏è ‰ΩìÈáçË®òÈå≤ÂÆå‰∫Ü | ${weight}kg ${height ? `BMI:${weightRecord.bmi}` : ''}`);
                    } else {
                        this.log('‚ùå ‰ΩìÈáçË®òÈå≤„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå ‰ΩìÈáçË®òÈå≤„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async loadWeightRecords() {
                this.log('‚öñÔ∏è ‰ΩìÈáçË®òÈå≤„ÇíË™≠„ÅøËæº„Åø‰∏≠...');
                
                try {
                    const response = await fetch('/api/weight/data');
                    const result = await response.json();
                    
                    const container = document.getElementById('weight-records');
                    
                    if (result.data && result.data.length === 0) {
                        container.innerHTML = '<p>‰ΩìÈáçË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                        return;
                    }
                    
                    let html = '';
                    
                    if (result.data) {
                        result.data.forEach(record => {
                            html += `
                                <div class="record-item">
                                    <div>
                                        <strong>${record.date}</strong> | ${record.weight}kg
                                        ${record.bmi ? ` | BMI: ${record.bmi}` : ''}
                                        ${record.memo ? `<br><small>${record.memo}</small>` : ''}
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    container.innerHTML = html || '<p>‰ΩìÈáçË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                    this.log('‚öñÔ∏è ‰ΩìÈáçË®òÈå≤„ÅÆË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå ‰ΩìÈáçË®òÈå≤Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                    document.getElementById('weight-records').innerHTML = '<p>‰ΩìÈáçË®òÈå≤„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
                }
            }

            calculateBMI() {
                this.log('üìä BMIË®àÁÆó„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const weight = parseFloat(document.getElementById('weight-value').value);
                const height = parseFloat(document.getElementById('weight-height').value);

                if (!weight || !height) {
                    this.log('‚ùå BMIË®àÁÆó: ‰ΩìÈáç„Å®Ë∫´Èï∑„ÅåÂøÖË¶Å„Åß„Åô');
                    alert('‰ΩìÈáç„Å®Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const bmi = (weight / Math.pow(height / 100, 2)).toFixed(1);
                let status = '';
                let statusClass = '';

                if (bmi < 18.5) {
                    status = '‰Ωé‰ΩìÈáç';
                    statusClass = 'bmi-underweight';
                } else if (bmi < 25) {
                    status = 'ÊôÆÈÄö‰ΩìÈáç';
                    statusClass = 'bmi-normal';
                } else if (bmi < 30) {
                    status = 'ËÇ•Ê∫ÄÔºà1Â∫¶Ôºâ';
                    statusClass = 'bmi-overweight';
                } else {
                    status = 'ËÇ•Ê∫ÄÔºà2Â∫¶‰ª•‰∏äÔºâ';
                    statusClass = 'bmi-obese';
                }

                document.getElementById('bmi-result').textContent = `BMI: ${bmi}`;
                document.getElementById('bmi-status').textContent = status;
                document.getElementById('bmi-status').className = `bmi-status ${statusClass}`;
                document.getElementById('bmi-section').style.display = 'block';

                this.log(`üìä BMIË®àÁÆóÂÆå‰∫Ü | BMI: ${bmi} (${status})`);
            }

            async exportWeightCSV() {
                this.log('üì• ‰ΩìÈáçÁÆ°ÁêÜCSVÂá∫Âäõ„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                try {
                    const response = await fetch('/api/weight/export/csv', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `weight_records_${new Date().toISOString().split('T')[0]}.csv`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                        
                        this.log('üì• ‰ΩìÈáçÁÆ°ÁêÜCSVÂá∫ÂäõÂÆå‰∫Ü');
                    } else {
                        this.log('‚ùå ‰ΩìÈáçÁÆ°ÁêÜCSVÂá∫Âäõ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå ‰ΩìÈáçÁÆ°ÁêÜCSVÂá∫Âäõ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // „Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ
            addFilterKeyword() {
                const input = document.getElementById('memo-filter-input');
                const keyword = input.value.trim();
                
                if (!keyword) {
                    this.log('‚ùå „Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„Éâ„ÅåÁ©∫„Åß„Åô');
                    alert('„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }
                
                if (this.filterKeywords.includes(keyword)) {
                    this.log('‚ùå Âêå„Åò„Ç≠„Éº„ÉØ„Éº„Éâ„ÅåÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô');
                    alert('Âêå„Åò„Ç≠„Éº„ÉØ„Éº„Éâ„ÅåÊó¢„Å´ËøΩÂä†„Åï„Çå„Å¶„ÅÑ„Åæ„Åô');
                    return;
                }
                
                if (this.filterKeywords.length >= this.maxFilterKeywords) {
                    this.log(`‚ùå „Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„Éâ„ÅØÊúÄÂ§ß${this.maxFilterKeywords}ÂÄã„Åæ„Åß`);
                    alert(`„Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„Éâ„ÅØÊúÄÂ§ß${this.maxFilterKeywords}ÂÄã„Åæ„ÅßËøΩÂä†„Åß„Åç„Åæ„Åô`);
                    return;
                }
                
                this.filterKeywords.push(keyword);
                input.value = '';
                
                this.updateFilterKeywordsDisplay();
                this.applyMemoFilter();
                
                this.log(`üîç „Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„ÉâËøΩÂä† | ${keyword} (${this.filterKeywords.length}/${this.maxFilterKeywords})`);
            }

            removeFilterKeyword(keyword) {
                const index = this.filterKeywords.indexOf(keyword);
                if (index > -1) {
                    this.filterKeywords.splice(index, 1);
                    this.updateFilterKeywordsDisplay();
                    this.applyMemoFilter();
                    
                    this.log(`üîç „Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„ÉâÂâäÈô§ | ${keyword} (${this.filterKeywords.length}/${this.maxFilterKeywords})`);
                }
            }

            clearAllFilters() {
                if (this.filterKeywords.length === 0) {
                    this.log('üìù „ÇØ„É™„Ç¢„Åô„Çã„Éï„Ç£„É´„Çø„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return;
                }
                
                this.filterKeywords = [];
                this.updateFilterKeywordsDisplay();
                this.applyMemoFilter();
                
                this.log('üóëÔ∏è ÂÖ®„Éï„Ç£„É´„Çø„Éº„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü');
            }

            updateFilterKeywordsDisplay() {
                const container = document.getElementById('filter-keywords');
                
                if (this.filterKeywords.length === 0) {
                    container.innerHTML = '<div class="filter-empty-state">„Éï„Ç£„É´„Çø„Éº„Ç≠„Éº„ÉØ„Éº„Éâ„Å™„ÅóÔºàÊúÄÂ§ß5ÂÄã„Åæ„ÅßËøΩÂä†ÂèØËÉΩÔºâ</div>';
                    return;
                }
                
                let html = '';
                this.filterKeywords.forEach(keyword => {
                    html += `
                        <div class="filter-keyword-tag">
                            <span>${keyword}</span>
                            <button class="remove-btn" onclick="app.removeFilterKeyword('${keyword}')" title="ÂâäÈô§">√ó</button>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            applyMemoFilter() {
                if (this.filterKeywords.length === 0) {
                    // „Éï„Ç£„É´„Çø„Éº„Å™„Åó„ÅÆÂ†¥Âêà„ÅØÂÖ®„É°„É¢„ÇíË°®Á§∫
                    this.loadMemos();
                    return;
                }
                
                // ÁèæÂú®„ÅÆ„É°„É¢‰∏ÄË¶ß„ÇíÂèñÂæó„Åó„Å¶ÂÜç„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
                this.filterCurrentMemos();
            }

            async filterCurrentMemos() {
                try {
                    const response = await fetch('/api/memo/data');
                    const result = await response.json();
                    
                    if (!result.data) {
                        return;
                    }
                    
                    // „Éï„Ç£„É´„Çø„Éº„ÇíÈÅ©Áî®
                    const filteredMemos = result.data.filter(memo => {
                        const searchableText = [
                            memo.title,
                            memo.content,
                            memo.category,
                            ...(Array.isArray(memo.tags) ? memo.tags : [])
                        ].join(' ').toLowerCase();
                        
                        // ÂÖ®„Å¶„ÅÆ„Ç≠„Éº„ÉØ„Éº„Éâ„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøË°®Á§∫ÔºàANDÊ§úÁ¥¢Ôºâ
                        return this.filterKeywords.every(keyword => 
                            searchableText.includes(keyword.toLowerCase())
                        );
                    });
                    
                    this.displayFilteredMemos(filteredMemos);
                    
                    this.log(`üîç „Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®ÂÆå‰∫Ü | ${filteredMemos.length}‰ª∂Ë°®Á§∫ („Ç≠„Éº„ÉØ„Éº„Éâ: ${this.filterKeywords.join(', ')})`);
                } catch (error) {
                    this.log(`‚ùå „Éï„Ç£„É´„Çø„ÉºÂá¶ÁêÜ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            displayFilteredMemos(memos) {
                const container = document.getElementById('memo-records');
                
                if (memos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: #666;">
                            <p>üîç „Éï„Ç£„É´„Çø„ÉºÊù°‰ª∂„Å´‰∏ÄËá¥„Åô„Çã„É°„É¢„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                            <p>„Ç≠„Éº„ÉØ„Éº„Éâ: ${this.filterKeywords.join(', ')}</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                
                memos.forEach(memo => {
                    const tagsHtml = Array.isArray(memo.tags) ? 
                        memo.tags.map(tag => `<span class="memo-tag">${tag}</span>`).join('') : '';
                    
                    html += `
                        <div class="memo-item">
                            <div class="memo-header">
                                <span class="memo-title">${memo.title}</span>
                                <span class="memo-category">${memo.category}</span>
                            </div>
                            <div class="memo-content">${memo.content}</div>
                            <div class="memo-meta">
                                <div>
                                    <span>${memo.date}</span>
                                    <div class="memo-tags">${tagsHtml}</div>
                                </div>
                                <button class="memo-delete-btn" onclick="deleteMemo('${memo.id}')">üóëÔ∏è ÂâäÈô§</button>
                            </div>
                        </div>
                    `;
                });
                
                // „Éï„Ç£„É´„Çø„ÉºÁµêÊûú„ÅÆ„Çµ„Éû„É™„Éº„ÇíÂÖàÈ†≠„Å´ËøΩÂä†
                html = `
                    <div style="background: #e9ecef; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                        <strong>„Éï„Ç£„É´„Çø„ÉºÁµêÊûú: ${memos.length}‰ª∂</strong> 
                        („Ç≠„Éº„ÉØ„Éº„Éâ: ${this.filterKeywords.join(', ')})
                    </div>
                ` + html;
                
                container.innerHTML = html;
            }

            // „É°„É¢ÁÆ°ÁêÜÊ©üËÉΩ
            async addMemo() {
                this.log('üìù „É°„É¢‰øùÂ≠ò„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const title = document.getElementById('memo-title').value;
                const content = document.getElementById('memo-textarea').value;
                const category = document.getElementById('memo-category').value;
                const tagsInput = document.getElementById('memo-tags').value;

                if (!title || !content) {
                    this.log('‚ùå „Çø„Ç§„Éà„É´„Å®ÂÜÖÂÆπ„ÅåÂøÖË¶Å„Åß„Åô');
                    alert('„Çø„Ç§„Éà„É´„Å®ÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];

                const memo = {
                    title,
                    content,
                    category,
                    tags,
                    userId: this.currentUser ? this.currentUser.uid : 'anonymous'
                };

                try {
                    const response = await fetch('/api/memo/add', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(memo)
                    });

                    if (response.ok) {
                        // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                        document.getElementById('memo-title').value = '';
                        document.getElementById('memo-textarea').value = '';
                        document.getElementById('memo-tags').value = '';
                        
                        this.loadMemos();
                        this.log(`üìù „É°„É¢‰øùÂ≠òÂÆå‰∫Ü | ${title} (${category})`);
                    } else {
                        this.log('‚ùå „É°„É¢„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå „É°„É¢‰øùÂ≠ò„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async loadMemos() {
                this.log('üìù „É°„É¢‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„Åø‰∏≠...');
                
                try {
                    const response = await fetch('/api/memo/data');
                    const result = await response.json();
                    
                    const container = document.getElementById('memo-records');
                    
                    if (result.data && result.data.length === 0) {
                        container.innerHTML = '<p>„É°„É¢„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                        return;
                    }
                    
                    let html = '';
                    
                    if (result.data) {
                        result.data.forEach(memo => {
                            const tagsHtml = Array.isArray(memo.tags) ? 
                                memo.tags.map(tag => `<span class="memo-tag">${tag}</span>`).join('') : '';
                            
                            html += `
                                <div class="memo-item">
                                    <div class="memo-header">
                                        <span class="memo-title">${memo.title}</span>
                                        <span class="memo-category">${memo.category}</span>
                                    </div>
                                    <div class="memo-content">${memo.content}</div>
                                    <div class="memo-meta">
                                        <div>
                                            <span>${memo.date}</span>
                                            <div class="memo-tags">${tagsHtml}</div>
                                        </div>
                                        <button class="memo-delete-btn" onclick="deleteMemo('${memo.id}')">üóëÔ∏è ÂâäÈô§</button>
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    container.innerHTML = html || '<p>„É°„É¢„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                    this.log('üìù „É°„É¢‰∏ÄË¶ß„ÅÆË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                } catch (error) {
                    this.log(`‚ùå „É°„É¢Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                    document.getElementById('memo-records').innerHTML = '<p>„É°„É¢„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
                }
            }

            async deleteMemo(memoId) {
                this.log(`üóëÔ∏è „É°„É¢ÂâäÈô§„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü | ID: ${memoId}`);
                
                if (!confirm('„Åì„ÅÆ„É°„É¢„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                    this.log('üìù „É°„É¢ÂâäÈô§„Çí„Ç≠„É£„É≥„Çª„É´„Åó„Åæ„Åó„Åü');
                    return;
                }

                try {
                    const response = await fetch(`/api/memo/delete/${memoId}`, {
                        method: 'DELETE'
                    });

                    if (response.ok) {
                        this.loadMemos();
                        this.log(`üóëÔ∏è „É°„É¢ÂâäÈô§ÂÆå‰∫Ü | ID: ${memoId}`);
                    } else {
                        this.log('‚ùå „É°„É¢„ÅÆÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå „É°„É¢ÂâäÈô§„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async exportMemoCSV() {
                this.log('üì• „É°„É¢CSVÂá∫Âäõ„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                try {
                    const response = await fetch('/api/memo/export/csv', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `memo_data_${new Date().toISOString().split('T')[0]}.csv`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                        
                        this.log('üì• „É°„É¢CSVÂá∫ÂäõÂÆå‰∫Ü');
                    } else {
                        this.log('‚ùå „É°„É¢CSVÂá∫Âäõ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå „É°„É¢CSVÂá∫Âäõ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // ================================================================
            // Ë®àÁÆóÊ©üÁÆ°ÁêÜÊ©üËÉΩ
            // ================================================================
            async calculateNumbers() {
                this.log('üßÆ Ë®àÁÆóÂÆüË°å„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                const numberA = parseFloat(document.getElementById('calc-number-a').value);
                const numberB = parseFloat(document.getElementById('calc-number-b').value);
                const resultElement = document.getElementById('calc-result');

                // „Éê„É™„Éá„Éº„Ç∑„Éß„É≥
                if (isNaN(numberA) || isNaN(numberB)) {
                    this.log('‚ùå ÊúâÂäπ„Å™Êï∞ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    alert('Êï∞ÂÄ§A „Å® Êï∞ÂÄ§B „Å´ÊúâÂäπ„Å™Êï∞ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    resultElement.textContent = '?';
                    return;
                }

                try {
                    const response = await fetch('/api/calc/calculate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            numberA: numberA,
                            numberB: numberB,
                            operation: 'add'
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        resultElement.textContent = result.calculation.result;
                        
                        this.loadCalcHistory();
                        this.log(`üßÆ Ë®àÁÆóÂÆå‰∫Ü | ${numberA} + ${numberB} = ${result.calculation.result}`);
                    } else {
                        this.log('‚ùå Ë®àÁÆóÂá¶ÁêÜ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                        resultElement.textContent = '„Ç®„É©„Éº';
                    }
                } catch (error) {
                    this.log(`‚ùå Ë®àÁÆó„Ç®„É©„Éº | ${error.message}`);
                    resultElement.textContent = '„Ç®„É©„Éº';
                }
            }

            clearCalculation() {
                document.getElementById('calc-number-a').value = '';
                document.getElementById('calc-number-b').value = '';
                document.getElementById('calc-result').textContent = '?';
                this.log('üóëÔ∏è Ë®àÁÆó„Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü');
            }

            async loadCalcHistory() {
                this.log('üìä Ë®àÁÆóÂ±•Ê≠¥„ÇíË™≠„ÅøËæº„Åø‰∏≠...');
                
                try {
                    const response = await fetch('/api/calc/history');
                    const result = await response.json();
                    
                    const container = document.getElementById('calc-history-list');
                    
                    if (!result.calculations || result.calculations.length === 0) {
                        container.innerHTML = '<div class="loading">Ë®àÁÆóÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                        return;
                    }
                    
                    let html = '';
                    
                    result.calculations.forEach(calc => {
                        const date = new Date(calc.timestamp).toLocaleString('ja-JP');
                        html += `
                            <div class="calc-history-item">
                                <div>
                                    <div class="calc-expression">${calc.numberA} + ${calc.numberB} = ${calc.result}</div>
                                    <div class="calc-timestamp">${date}</div>
                                </div>
                                <button class="calc-delete-btn" onclick="deleteCalcHistory('${calc.id}')">üóëÔ∏è</button>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                    this.log('üìä Ë®àÁÆóÂ±•Ê≠¥„ÅÆË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                    
                } catch (error) {
                    this.log(`‚ùå Ë®àÁÆóÂ±•Ê≠¥Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async deleteCalcHistory(calcId) {
                this.log(`üóëÔ∏è Ë®àÁÆóÂ±•Ê≠¥ÂâäÈô§ | ID: ${calcId}`);
                
                try {
                    const response = await fetch(`/api/calc/history/${calcId}`, {
                        method: 'DELETE'
                    });

                    if (response.ok) {
                        this.loadCalcHistory();
                        this.log(`üóëÔ∏è Ë®àÁÆóÂ±•Ê≠¥ÂâäÈô§ÂÆå‰∫Ü | ID: ${calcId}`);
                    } else {
                        this.log('‚ùå Ë®àÁÆóÂ±•Ê≠¥„ÅÆÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå Ë®àÁÆóÂ±•Ê≠¥ÂâäÈô§„Ç®„É©„Éº | ${error.message}`);
                }
            }

            async exportCalcCSV() {
                this.log('üì• Ë®àÁÆóÂ±•Ê≠¥CSVÂá∫Âäõ„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Åæ„Åó„Åü');
                
                try {
                    const response = await fetch('/api/calc/export/csv', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `calc_history_${new Date().toISOString().slice(0, 10)}.csv`;
                        document.body.appendChild(a);
                        a.click();
                        a.remove();
                        window.URL.revokeObjectURL(url);
                        
                        this.log('üì• Ë®àÁÆóÂ±•Ê≠¥CSVÂá∫ÂäõÂÆå‰∫Ü');
                    } else {
                        this.log('‚ùå Ë®àÁÆóÂ±•Ê≠¥CSVÂá∫Âäõ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå Ë®àÁÆóÂ±•Ê≠¥CSVÂá∫Âäõ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            // ================================================================
            // Ë®≠ÂÆöÁÆ°ÁêÜUIÊ©üËÉΩ
            // ================================================================
            async loadConfigUI() {
                this.log('‚öôÔ∏è Ë®≠ÂÆöUI„ÇíË™≠„ÅøËæº„Åø‰∏≠...');
                
                try {
                    const response = await fetch('/api/config');
                    const result = await response.json();
                    
                    // „Ç¢„Éó„É™ÊúâÂäπÂåñ„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ
                    this.renderAppCheckboxes(result.config);
                    
                    // Ê©üËÉΩË®≠ÂÆö„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ
                    this.renderFeatureCheckboxes(result.config);
                    
                    this.log('‚öôÔ∏è Ë®≠ÂÆöUIË™≠„ÅøËæº„ÅøÂÆå‰∫Ü');
                    
                } catch (error) {
                    this.log(`‚ùå Ë®≠ÂÆöUIË™≠„ÅøËæº„Åø„Ç®„É©„Éº | ${error.message}`);
                }
            }

            renderAppCheckboxes(config) {
                const container = document.getElementById('enabledAppsCheckboxes');
                const allApps = {
                    'money': { name: '„ÅäÈáëÁÆ°ÁêÜ', icon: 'üí∞' },
                    'time': { name: 'ÊôÇÈñìÁÆ°ÁêÜ', icon: '‚è∞' },
                    'weight': { name: '‰ΩìÈáçÁÆ°ÁêÜ', icon: '‚öñÔ∏è' },
                    'memo': { name: '„É°„É¢ÁÆ°ÁêÜ', icon: 'üìù' },
                    'calc': { name: 'Ë®àÁÆóÊ©ü', icon: 'üßÆ' }
                };

                let html = '';
                Object.keys(allApps).forEach(appKey => {
                    const app = allApps[appKey];
                    const isEnabled = config.enabledApps && config.enabledApps.includes(appKey);
                    const checkedAttribute = isEnabled ? 'checked' : '';
                    const enabledClass = isEnabled ? 'enabled' : '';
                    
                    html += `
                        <div class="checkbox-item ${enabledClass}">
                            <input type="checkbox" id="app-${appKey}" ${checkedAttribute} onchange="toggleApp('${appKey}')">
                            <label for="app-${appKey}">
                                <span class="app-icon">${app.icon}</span>
                                ${app.name}
                            </label>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            renderFeatureCheckboxes(config) {
                const container = document.getElementById('featuresCheckboxes');
                const features = {
                    'firebaseAuth': { name: 'FirebaseË™çË®º', icon: 'üîê' },
                    'realtimeDatabase': { name: '„É™„Ç¢„É´„Çø„Ç§„É†DB', icon: 'üîÑ' },
                    'csvExport': { name: 'CSVÂá∫ÂäõÊ©üËÉΩ', icon: 'üìä' },
                    'jsonLogs': { name: 'JSON„É≠„Ç∞', icon: 'üìù' },
                    'debugMode': { name: '„Éá„Éê„ÉÉ„Ç∞„É¢„Éº„Éâ', icon: 'üêõ' }
                };

                let html = '';
                Object.keys(features).forEach(featureKey => {
                    const feature = features[featureKey];
                    const isEnabled = config.features && config.features[featureKey];
                    const checkedAttribute = isEnabled ? 'checked' : '';
                    const enabledClass = isEnabled ? 'enabled' : '';
                    
                    html += `
                        <div class="checkbox-item ${enabledClass}">
                            <input type="checkbox" id="feature-${featureKey}" ${checkedAttribute} onchange="toggleFeature('${featureKey}')">
                            <label for="feature-${featureKey}">
                                <span class="app-icon">${feature.icon}</span>
                                ${feature.name}
                            </label>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }

            async saveConfigUI() {
                this.log('üíæ Ë®≠ÂÆö‰øùÂ≠òÈñãÂßã...');
                
                try {
                    // ÁèæÂú®„ÅÆË®≠ÂÆö„ÇíÂèñÂæó
                    const response = await fetch('/api/config');
                    const currentConfig = await response.json();
                    
                    // „Ç¢„Éó„É™Ë®≠ÂÆö„ÇíÊõ¥Êñ∞
                    const enabledApps = [];
                    const appCheckboxes = document.querySelectorAll('#enabledAppsCheckboxes input[type="checkbox"]');
                    appCheckboxes.forEach(checkbox => {
                        if (checkbox.checked) {
                            const appName = checkbox.id.replace('app-', '');
                            enabledApps.push(appName);
                        }
                    });
                    
                    // Ê©üËÉΩË®≠ÂÆö„ÇíÊõ¥Êñ∞
                    const features = { ...currentConfig.config.features };
                    const featureCheckboxes = document.querySelectorAll('#featuresCheckboxes input[type="checkbox"]');
                    featureCheckboxes.forEach(checkbox => {
                        const featureName = checkbox.id.replace('feature-', '');
                        features[featureName] = checkbox.checked;
                    });
                    
                    // Ë®≠ÂÆö„Çí‰øùÂ≠ò
                    const updatedConfig = {
                        ...currentConfig.config,
                        enabledApps: enabledApps,
                        features: features
                    };
                    
                    const saveResponse = await fetch('/api/config', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(updatedConfig)
                    });
                    
                    if (saveResponse.ok) {
                        this.log('üíæ Ë®≠ÂÆö‰øùÂ≠òÂÆå‰∫Ü');
                        alert('Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü„ÄÇ\\nÂ§âÊõ¥„ÇíÈÅ©Áî®„Åô„Çã„Å´„ÅØ„Çµ„Éº„Éê„Éº„ÇíÂÜçËµ∑Âãï„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    } else {
                        this.log('‚ùå Ë®≠ÂÆö‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                        alert('Ë®≠ÂÆö„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
                    }
                    
                } catch (error) {
                    this.log(`‚ùå Ë®≠ÂÆö‰øùÂ≠ò„Ç®„É©„Éº | ${error.message}`);
                    alert('Ë®≠ÂÆö„ÅÆ‰øùÂ≠ò‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ');
                }
            }

            toggleApp(appName) {
                const checkbox = document.getElementById(`app-${appName}`);
                const container = checkbox.closest('.checkbox-item');
                
                if (checkbox.checked) {
                    container.classList.add('enabled');
                } else {
                    container.classList.remove('enabled');
                }
                
                this.log(`üì± „Ç¢„Éó„É™Âàá„ÇäÊõø„Åà | ${appName}: ${checkbox.checked ? 'ON' : 'OFF'}`);
            }

            toggleFeature(featureName) {
                const checkbox = document.getElementById(`feature-${featureName}`);
                const container = checkbox.closest('.checkbox-item');
                
                if (checkbox.checked) {
                    container.classList.add('enabled');
                } else {
                    container.classList.remove('enabled');
                }
                
                this.log(`‚öôÔ∏è Ê©üËÉΩÂàá„ÇäÊõø„Åà | ${featureName}: ${checkbox.checked ? 'ON' : 'OFF'}`);
            }

            // „É≠„Ç∞Ê©üËÉΩ
            log(message) {
                const timestamp = new Date().toLocaleTimeString('ja-JP');
                const logEntry = `[${timestamp}] ${message}`;
                this.logs.push(logEntry);
                
                const debugLogs = document.getElementById('debugLogs');
                if (debugLogs) {
                    debugLogs.textContent = this.logs.slice(-50).join('\\n');
                    debugLogs.scrollTop = debugLogs.scrollHeight;
                }
                console.log(logEntry);
            }

            async downloadLogs() {
                try {
                    const response = await fetch('/api/generate-log', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ source: 'smart-template-ui', logs: this.logs })
                    });

                    const data = await response.json();
                    
                    if (data.success) {
                        this.log(`üìÑ „É≠„Ç∞„Éï„Ç°„Ç§„É´ÁîüÊàêÂÆå‰∫Ü | ${data.filename}`);
                    } else {
                        throw new Error(data.error || '„É≠„Ç∞„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                } catch (error) {
                    this.log(`‚ùå „É≠„Ç∞„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Ç®„É©„Éº | ${error.message}`);
                }
            }

            clearLogs() {
                this.logs = [];
                document.getElementById('debugLogs').textContent = '„É≠„Ç∞„Åå„ÇØ„É™„Ç¢„Åï„Çå„Åæ„Åó„Åü';
                this.log('üóëÔ∏è „É≠„Ç∞„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü');
            }

            refreshLogs() {
                const debugLogs = document.getElementById('debugLogs');
                debugLogs.textContent = this.logs.slice(-50).join('\\n');
                debugLogs.scrollTop = debugLogs.scrollHeight;
                this.log('üîÑ „É≠„Ç∞Ë°®Á§∫„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
            }
        }

        // „Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞
        let app;
        
        window.addEventListener('load', () => {
            app = new SmartTemplateApp();
        });
        
        function testAPI() { app.testAPI(); }
        function downloadLogs() { app.downloadLogs(); }
        function clearLogs() { app.clearLogs(); }
        function refreshLogs() { app.refreshLogs(); }
        function generateSampleData() { app.generateSampleData(); }
        function loadConfig() { app.loadConfig(); }
        function saveConfig() { app.saveConfig(); }
        function addMoneyTransaction() { app.addMoneyTransaction(); }
        function exportMoneyCSV() { app.exportMoneyCSV(); }
        function copyLogsToClipboard() { app.copyLogsToClipboard(); }
        
        // ÊôÇÈñìÁÆ°ÁêÜÈñ¢Êï∞
        function addTimeRecord() { app.addTimeRecord(); }
        function startTimer() { app.startTimer(); }
        function pauseTimer() { app.pauseTimer(); }
        function stopTimer() { app.stopTimer(); }
        function exportTimeCSV() { app.exportTimeCSV(); }
        
        // ‰ΩìÈáçÁÆ°ÁêÜÈñ¢Êï∞
        function addWeightRecord() { app.addWeightRecord(); }
        function calculateBMI() { app.calculateBMI(); }
        function exportWeightCSV() { app.exportWeightCSV(); }
        
        // „É°„É¢ÁÆ°ÁêÜÈñ¢Êï∞
        function addMemo() { app.addMemo(); }
        function deleteMemo(memoId) { app.deleteMemo(memoId); }
        function exportMemoCSV() { app.exportMemoCSV(); }
        
        // „Éï„Ç£„É´„Çø„ÉºÈñ¢Êï∞
        function addFilterKeyword() { app.addFilterKeyword(); }
        function clearAllFilters() { app.clearAllFilters(); }

        // Ë®àÁÆóÊ©üÁÆ°ÁêÜÈñ¢Êï∞
        function calculateNumbers() { app.calculateNumbers(); }
        function clearCalculation() { app.clearCalculation(); }
        function deleteCalcHistory(calcId) { app.deleteCalcHistory(calcId); }
        function exportCalcCSV() { app.exportCalcCSV(); }

        // Ë®≠ÂÆöÁÆ°ÁêÜUIÈñ¢Êï∞
        function loadConfigUI() { app.loadConfigUI(); }
        function saveConfigUI() { app.saveConfigUI(); }
        function toggleApp(appName) { app.toggleApp(appName); }
        function toggleFeature(featureName) { app.toggleFeature(featureName); }
        
        function resetConfig() { app.resetConfig(); }
        
        // „É≠„Ç∞Èñ≤Ë¶ßÊ©üËÉΩ
        let currentLogData = [];
        let allLogLines = [];
        let isAllLogsMode = false;
        
        function loadAllLogs() {
            isAllLogsMode = true;
            document.getElementById('logFileSelect').value = '';
            
            fetch('/api/logs/all')
                .then(response => response.json())
                .then(data => {
                    allLogLines = data.lines;
                    displayLogLines(allLogLines);
                    updateSearchCount(allLogLines.length);
                    
                    const display = document.getElementById('logDisplay');
                    display.scrollTop = 0; // ÂÖàÈ†≠„Å´Êàª„Çã
                    
                    console.log(`üìö ÂÖ®„É≠„Ç∞‰∏ÄÊã¨Ë°®Á§∫: ${data.totalFiles}„Éï„Ç°„Ç§„É´„ÄÅ${data.totalLines}Ë°å`);
                })
                .catch(error => {
                    console.error('ÂÖ®„É≠„Ç∞„ÅÆÂèñÂæó„Å´Â§±Êïó:', error);
                    document.getElementById('logDisplay').textContent = 'ÂÖ®„É≠„Ç∞„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü';
                    allLogLines = [];
                });
        }
        
        function loadLogFiles() {
            fetch('/api/logs/files')
                .then(response => response.json())
                .then(data => {
                    const select = document.getElementById('logFileSelect');
                    select.innerHTML = '<option value="">„É≠„Ç∞„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>';
                    
                    data.files.forEach(file => {
                        const option = document.createElement('option');
                        option.value = file.name;
                        option.textContent = `${file.name} (${formatFileSize(file.size)}) - ${formatDate(file.modified)}`;
                        select.appendChild(option);
                    });
                    
                    console.log(`üìã „É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ßÊõ¥Êñ∞: ${data.files.length}‰ª∂`);
                })
                .catch(error => {
                    console.error('„É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ß„ÅÆÂèñÂæó„Å´Â§±Êïó:', error);
                    document.getElementById('logDisplay').textContent = '„É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ß„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü';
                });
        }
        
        function loadSelectedLog() {
            const select = document.getElementById('logFileSelect');
            const filename = select.value;
            
            isAllLogsMode = false;
            
            if (!filename) {
                document.getElementById('logDisplay').textContent = 'ÂÄãÂà•„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åô„Çã„Åã„ÄÅ„ÄåÂÖ®„É≠„Ç∞‰∏ÄÊã¨Ë°®Á§∫„Äç„Çí„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ';
                allLogLines = [];
                return;
            }
            
            fetch(`/api/logs/content/${filename}`)
                .then(response => response.json())
                .then(data => {
                    allLogLines = data.lines;
                    displayLogLines(allLogLines);
                    updateSearchCount(allLogLines.length);
                    console.log(`üìÑ „É≠„Ç∞„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø: ${filename} (${data.totalLines}Ë°å)`);
                })
                .catch(error => {
                    console.error('„É≠„Ç∞„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó:', error);
                    document.getElementById('logDisplay').textContent = '„É≠„Ç∞„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü';
                    allLogLines = [];
                });
        }
        
        function filterLogLines() {
            const searchInput = document.getElementById('logSearchInput');
            const keyword = searchInput.value.toLowerCase();
            
            if (!keyword) {
                displayLogLines(allLogLines);
                updateSearchCount(allLogLines.length);
                return;
            }
            
            const filteredLines = allLogLines.filter(line => 
                line.content.toLowerCase().includes(keyword)
            );
            
            displayLogLines(filteredLines, keyword);
            updateSearchCount(filteredLines.length);
        }
        
        function clearLogSearch() {
            document.getElementById('logSearchInput').value = '';
            displayLogLines(allLogLines);
            updateSearchCount(allLogLines.length);
        }
        
        function displayLogLines(lines, highlightKeyword = null) {
            const display = document.getElementById('logDisplay');
            
            if (lines.length === 0) {
                display.textContent = '„É≠„Ç∞„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì';
                return;
            }
            
            const content = lines.map(line => {
                let content = line.content;
                let className = 'log-line';
                
                // ÂÖ®„É≠„Ç∞„É¢„Éº„Éâ„Åß„Éï„Ç°„Ç§„É´„Éò„ÉÉ„ÉÄ„Éº„ÅÆÁâπÂà•Âá¶ÁêÜ
                if (isAllLogsMode && line.isHeader) {
                    className += ' log-header';
                }
                
                if (highlightKeyword) {
                    const regex = new RegExp(`(${escapeRegex(highlightKeyword)})`, 'gi');
                    content = content.replace(regex, '<mark>$1</mark>');
                }
                
                // Ë°åÁï™Âè∑„Å´„Éï„Ç°„Ç§„É´Âêç„Éó„É¨„Éï„Ç£„ÉÉ„ÇØ„Çπ„ÇíËøΩÂä†ÔºàÂÖ®„É≠„Ç∞„É¢„Éº„ÉâÊôÇÔºâ
                let linePrefix = line.lineNumber.toString().padStart(4, ' ');
                if (isAllLogsMode && line.fileName && !line.isHeader) {
                    const filePrefix = line.fileName.substring(0, 4); // „Éï„Ç°„Ç§„É´Âêç„ÅÆÊúÄÂàù4ÊñáÂ≠ó
                    linePrefix = `${filePrefix}:${line.lineNumber.toString().padStart(3, ' ')}`;
                }
                
                return `<div class="${className}">${linePrefix}: ${content}</div>`;
            }).join('');
            
            display.innerHTML = content;
        }
        
        function updateSearchCount(count) {
            document.getElementById('searchResultCount').textContent = `${count}‰ª∂`;
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString('ja-JP');
        }
        
        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }
        
        // „Éö„Éº„Ç∏„É≠„Éº„ÉâÊôÇ„Å´„É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„ÇÄ
        document.addEventListener('DOMContentLoaded', function() {
            // „Çø„Éñ„ÇØ„É™„ÉÉ„ÇØÊôÇ„ÅÆÂá¶ÁêÜ„Åß„ÄÅ„É≠„Ç∞„Çø„Éñ„ÅåÈÅ∏Êäû„Åï„Çå„ÅüÊôÇ„Å´„É≠„Ç∞„Éï„Ç°„Ç§„É´‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„ÇÄ
            const originalShowAppContent = window.showAppContent || function() {};
            window.showAppContent = function(appName) {
                originalShowAppContent(appName);
                if (appName === 'logs' && document.getElementById('logFileSelect').children.length <= 1) {
                    loadLogFiles();
                }
            };
        });
    </script>
</body>
</html>