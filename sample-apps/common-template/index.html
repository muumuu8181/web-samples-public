<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ çµ±åˆã‚¢ãƒ—ãƒªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v1.0</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --primary: #4CAF50;
            --secondary: #2196F3;
            --warning: #FF9800;
            --danger: #f44336;
            --success: #4CAF50;
            --bg: #f8f9fa;
            --surface: #fff;
            --text: #333;
            --text-light: #666;
            --border: #ddd;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --border-radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            background: var(--surface);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            color: var(--primary);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .version-badge {
            background: var(--secondary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: normal;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .auth-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .auth-btn:hover {
            opacity: 0.9;
        }

        /* ã‚¢ãƒ—ãƒªã‚¿ãƒ– */
        .app-tabs {
            display: flex;
            background: var(--surface);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .app-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 15px 20px;
            cursor: pointer;
            border: none;
            background: none;
            color: var(--text-light);
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .app-tab:hover {
            background: var(--bg);
            color: var(--text);
        }

        .app-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: var(--bg);
        }

        .app-tab .icon {
            font-size: 1.2rem;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-content {
            background: var(--surface);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            min-height: 500px;
        }

        .app-content {
            display: none;
            padding: 20px;
        }

        .app-content.active {
            display: block;
        }

        .welcome-content {
            text-align: center;
            padding: 60px 20px;
        }

        .welcome-content h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .welcome-content p {
            color: var(--text-light);
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        /* ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± */
        .system-info {
            background: var(--bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-card {
            background: var(--surface);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--primary);
        }

        .info-card h4 {
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .info-card p {
            color: var(--text);
            font-weight: 500;
        }

        /* ãƒœã‚¿ãƒ³ */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-danger {
            background: var(--danger);
        }

        /* ãƒ­ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .log-section {
            margin-top: 20px;
        }

        .log-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .debug-logs {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-line;
        }

        /* å‹•ä½œç¢ºèªã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .verification-section {
            margin-top: 20px;
            background: var(--surface);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .verification-status {
            text-align: center;
            margin-bottom: 20px;
        }

        .status-indicator {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status-indicator.running {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeaa7;
        }

        .status-indicator.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #4CAF50;
        }

        .status-indicator.failed {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f44336;
        }

        .verification-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .verification-step {
            background: var(--bg);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--border);
        }

        .verification-step.success {
            border-left-color: var(--success);
        }

        .verification-step.failed {
            border-left-color: var(--danger);
        }

        .verification-step.running {
            border-left-color: var(--warning);
        }

        .verification-evidence {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid var(--border);
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        /* è¨­å®šãƒ‘ãƒãƒ« */
        .settings-panel {
            background: var(--bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        /* ãŠé‡‘ç®¡ç†ç”»é¢ */
        .money-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .input-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .input-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .form-control {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            flex: 1;
            min-width: 120px;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
        }

        .transaction-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .transactions-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-income {
            border-left: 4px solid var(--success);
        }

        .transaction-expense {
            border-left: 4px solid var(--danger);
        }

        /* æ™‚é–“ç®¡ç†ãƒ»ä½“é‡ç®¡ç†ç”»é¢ */
        .time-panel, .weight-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .timer-section, .bmi-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
        }

        .timer-display, .bmi-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 20px;
            margin: 10px 0;
        }

        .timer-clock {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }

        .timer-controls {
            margin: 15px 0;
        }

        .timer-task {
            font-size: 1.1rem;
            color: #666;
            margin-top: 10px;
        }

        .bmi-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .bmi-status {
            font-size: 1.2rem;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }

        .bmi-underweight { background: #e3f2fd; color: #1976d2; }
        .bmi-normal { background: #e8f5e8; color: #388e3c; }
        .bmi-overweight { background: #fff3e0; color: #f57c00; }
        .bmi-obese { background: #ffebee; color: #d32f2f; }

        .time-list, .weight-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .records-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
        }

        .record-item:last-child {
            border-bottom: none;
        }

        .record-work { border-left: 4px solid #2196F3; }
        .record-study { border-left: 4px solid #4CAF50; }
        .record-exercise { border-left: 4px solid #FF9800; }
        .record-break { border-left: 4px solid #9C27B0; }
        .record-other { border-left: 4px solid #607D8B; }

        /* ãƒ¡ãƒ¢ç®¡ç†ç”»é¢ */
        .memo-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .memo-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .memo-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
        }

        .memo-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .memo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .memo-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }

        .memo-category {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .memo-content {
            margin: 10px 0;
            line-height: 1.5;
            color: #555;
            white-space: pre-wrap;
        }

        .memo-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .memo-tags {
            display: flex;
            gap: 5px;
        }

        .memo-tag {
            background: #e9ecef;
            color: #495057;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .memo-delete-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .memo-delete-btn:hover {
            opacity: 0.8;
        }

        /* è¨ˆç®—æ©Ÿã‚¹ã‚¿ã‚¤ãƒ« */
        .calc-form {
            background: var(--surface);
            padding: 20px;
            border-radius: var(--border-radius);
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .calc-input-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .calc-input {
            width: 120px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }

        .calc-operator, .calc-equals {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            min-width: 30px;
            text-align: center;
        }

        .calc-result {
            font-size: 24px;
            font-weight: bold;
            color: var(--success);
            min-width: 100px;
            background: var(--bg);
            padding: 8px 15px;
            border-radius: 6px;
            border: 2px solid var(--success);
            text-align: center;
        }

        .calc-button-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .calc-btn {
            background: var(--primary);
            font-size: 16px;
            font-weight: bold;
            min-width: 120px;
        }

        .calc-history-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--surface);
        }

        .calc-history-item {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .calc-history-item:last-child {
            border-bottom: none;
        }

        .calc-history-item:hover {
            background: var(--bg);
        }

        .calc-expression {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
        }

        .calc-timestamp {
            color: var(--text-light);
            font-size: 12px;
        }

        .calc-delete-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .calc-delete-btn:hover {
            opacity: 0.8;
        }

        .config-editor {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            width: 100%;
            min-height: 200px;
            resize: vertical;
        }

        /* è¨­å®šç®¡ç†UI */
        .config-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .checkbox-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg);
            transition: background-color 0.2s;
        }

        .checkbox-item:hover {
            background: #f0f0f0;
        }

        .checkbox-item input[type="checkbox"] {
            margin: 0;
            transform: scale(1.1);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            flex: 1;
            font-weight: normal;
        }

        .checkbox-item.enabled {
            background: #e8f5e8;
            border-color: var(--success);
        }

        .app-icon {
            font-size: 16px;
            margin-right: 4px;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .app-tabs {
                flex-direction: column;
            }
            
            .app-tab {
                justify-content: center;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        .status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .status-success {
            background: #e8f5e8;
            color: #2e7d2e;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
        }

        /* ãƒ­ã‚°é–²è¦§ç”»é¢ */
        .logs-panel {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .log-selection, .log-search, .log-content {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--bg);
            border-radius: 6px;
        }

        .log-controls, .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .log-display {
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            padding: 15px;
            border-radius: 4px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #333;
        }

        .log-line {
            padding: 2px 0;
            border-bottom: 1px solid #333;
        }

        .log-line:last-child {
            border-bottom: none;
        }

        .log-line.highlight {
            background: #264f78;
            color: #ffffff;
        }

        .log-header {
            background: #2d4a5a !important;
            color: #87ceeb !important;
            font-weight: bold;
            border: none !important;
        }

        .file-name {
            color: #87ceeb;
            font-size: 0.9rem;
            font-weight: normal;
            opacity: 0.8;
        }

        .search-count {
            color: var(--primary);
            font-weight: bold;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header>
            <h1>
                ğŸš€ çµ±åˆã‚¢ãƒ—ãƒªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
                <span class="version-badge">v0.3</span>
            </h1>
            <div class="user-info" id="userInfo">
                <div class="status" id="connectionStatus">
                    <span class="loading"></span>
                    <span>æ¥ç¶šä¸­...</span>
                </div>
                <button class="auth-btn" id="authBtn">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</button>
            </div>
        </header>

        <!-- ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± -->
        <div class="system-info">
            <h3>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</h3>
            <div class="info-grid" id="systemInfo">
                <div class="info-card">
                    <h4>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</h4>
                    <p id="version">0.3</p>
                </div>
                <div class="info-card">
                    <h4>æœ‰åŠ¹ã‚¢ãƒ—ãƒªæ•°</h4>
                    <p id="enabledApps">èª­ã¿è¾¼ã¿ä¸­...</p>
                </div>
            </div>
        </div>

        <!-- ã‚¢ãƒ—ãƒªã‚¿ãƒ– -->
        <div class="app-tabs" id="appTabs">
            <button class="app-tab active" data-app="simple">
                <span class="icon">ğŸ“„</span>
                <span>ã‚·ãƒ³ãƒ—ãƒ«</span>
            </button>
            <button class="app-tab" data-app="settings">
                <span class="icon">âš™ï¸</span>
                <span>è¨­å®š</span>
            </button>
            <button class="app-tab" data-app="logs">
                <span class="icon">ğŸ“‹</span>
                <span>ãƒ­ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</span>
            </button>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div class="main-content">
            <!-- ã‚·ãƒ³ãƒ—ãƒ«ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªç”»é¢ -->
            <div class="app-content active" id="simple-content">
                <!-- å‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ -->
            </div>

            <!-- è¨­å®šç”»é¢ -->
            <div class="app-content" id="settings-content">
                <div class="settings-panel">
                    <h3>âš™ï¸ è¨­å®šç®¡ç†</h3>
                    <p>config.json ã®å†…å®¹ã‚’ç·¨é›†ã§ãã¾ã™ã€‚å¤‰æ›´å¾Œã¯ã€Œè¨­å®šã‚’ä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
                    
                    <!-- ã‚¢ãƒ—ãƒªæœ‰åŠ¹åŒ–è¨­å®š -->
                    <div class="config-section">
                        <h4>ğŸ“± æœ‰åŠ¹ãªã‚¢ãƒ—ãƒª</h4>
                        <div class="checkbox-list" id="enabledAppsCheckboxes">
                            <div class="loading">è¨­å®šã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
                        </div>
                    </div>

                    <!-- æ©Ÿèƒ½è¨­å®š -->
                    <div class="config-section">
                        <h4>âš™ï¸ æ©Ÿèƒ½è¨­å®š</h4>
                        <div class="checkbox-list" id="featuresCheckboxes">
                            <div class="loading">è¨­å®šã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
                        </div>
                    </div>

                    <!-- ä¿å­˜ãƒ»ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ -->
                    <div style="margin: 20px 0;">
                        <button class="btn" onclick="loadConfigUI()">ğŸ“¥ è¨­å®šèª­ã¿è¾¼ã¿</button>
                        <button class="btn btn-secondary" onclick="saveConfigUI()">ğŸ’¾ è¨­å®šä¿å­˜</button>
                        <button class="btn btn-warning" onclick="resetConfig()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                    
                    <!-- é«˜åº¦ãªè¨­å®šï¼ˆJSONç·¨é›†ï¼‰ -->
                    <div class="config-section">
                        <h4>ğŸ”§ é«˜åº¦ãªè¨­å®š (JSON)</h4>
                        <details>
                            <summary>ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘è¨­å®šç·¨é›†</summary>
                            <textarea class="config-editor" id="configEditor" placeholder="è¨­å®šã‚’èª­ã¿è¾¼ã¿ä¸­..."></textarea>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-secondary" onclick="loadConfig()">ğŸ“¥ JSONèª­ã¿è¾¼ã¿</button>
                                <button class="btn btn-secondary" onclick="saveConfig()">ğŸ’¾ JSONä¿å­˜</button>
                            </div>
                        </details>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <div class="status status-warning">
                            <span>âš ï¸</span>
                            <span>è¨­å®šå¤‰æ›´å¾Œã¯ã‚µãƒ¼ãƒãƒ¼ã®å†èµ·å‹•ãŒå¿…è¦ã§ã™</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒ­ã‚°é–²è¦§ç”»é¢ -->
            <div class="app-content" id="logs-content">
                <div class="logs-panel">
                    <h3>ğŸ“‹ ãƒ­ã‚°é–²è¦§</h3>
                    <p>ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸéå»ã®ãƒ­ã‚°ã‚’é–²è¦§ãƒ»æ¤œç´¢ã§ãã¾ã™ã€‚</p>
                    
                    <!-- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ -->
                    <div class="log-selection">
                        <h4>ğŸ“ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§</h4>
                        <div class="log-controls">
                            <button class="btn" onclick="loadLogFiles()">ğŸ”„ ãƒªã‚¹ãƒˆæ›´æ–°</button>
                            <button class="btn btn-secondary" onclick="loadAllLogs()">ğŸ“š å…¨ãƒ­ã‚°ä¸€æ‹¬è¡¨ç¤º</button>
                            <select id="logFileSelect" class="form-control" onchange="loadSelectedLog()">
                                <option value="">å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                    <div class="log-search">
                        <h4>ğŸ” æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h4>
                        <p style="font-size: 12px; color: #666; margin-bottom: 10px;">
                            ğŸ’¡ ä½¿ã„æ–¹: ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã«æ¤œç´¢ã—ãŸã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã“ã®ã‚¿ãƒ–å†…ã®ãƒ­ã‚°ã®ã¿ãŒãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™<br>
                            ğŸ›¡ï¸ å®‰å…¨: ä¸‹éƒ¨ã®ã€Œã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã€ï¼ˆç·‘ç”»é¢ï¼‰ã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“
                        </p>
                        <div class="search-controls">
                            <input type="text" id="logSearchInput" class="form-control" placeholder="ä¾‹: ã‚¨ãƒ©ãƒ¼, æˆåŠŸ, åˆæœŸåŒ–..." oninput="filterLogLines()">
                            <button class="btn btn-secondary" onclick="clearLogSearch()">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
                            <span id="searchResultCount" class="search-count">å…¨ãƒ­ã‚°è¡¨ç¤ºä¸­</span>
                        </div>
                    </div>
                    
                    <!-- ãƒ­ã‚°å†…å®¹è¡¨ç¤º -->
                    <div class="log-content">
                        <h4>ğŸ“„ ãƒ­ã‚°å†…å®¹</h4>
                        <div id="logDisplay" class="log-display">
                            ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å‹•çš„ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
        </div>

        <!-- ãƒ­ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="log-section">
            <h3>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°</h3>
            <div class="log-controls">
                <button class="btn btn-primary" onclick="runFullSystemVerification()" id="verificationBtn">ğŸ§ª å…¨æ©Ÿèƒ½å‹•ä½œç¢ºèª</button>
                <button class="btn" onclick="downloadLogs()">ğŸ“¥ ãƒ­ã‚°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                <button class="btn btn-secondary" onclick="copyLogsToClipboard()">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼</button>
                <button class="btn" onclick="clearLogs()">ğŸ—‘ï¸ ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
                <button class="btn" onclick="refreshLogs()">ğŸ”„ ãƒ­ã‚°æ›´æ–°</button>
            </div>
            <div class="debug-logs" id="debugLogs">ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...</div>
        </div>

        <!-- å‹•ä½œç¢ºèªçµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="verification-section" id="verificationSection" style="display: none;">
            <h3>ğŸ§ª çµ±åˆå‹•ä½œç¢ºèªçµæœ</h3>
            <div class="verification-status" id="verificationStatus">
                <div class="status-indicator" id="statusIndicator">æº–å‚™ä¸­...</div>
            </div>
            <div class="verification-details" id="verificationDetails"></div>
            <div class="verification-evidence" id="verificationEvidence"></div>
        </div>
    </div>

    <script>
        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        console.log('ğŸš€ çµ±åˆã‚¢ãƒ—ãƒªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹');
        
        // åŸºæœ¬çš„ãªè¡¨ç¤ºæ©Ÿèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('connectionStatus').innerHTML = '<span>âœ…</span><span>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</span>';
            loadAndSetupDynamicTabs();
            console.log('âœ… å‹•çš„ã‚¿ãƒ–èª­ã¿è¾¼ã¿é–‹å§‹');
        });
        
        // å‹•çš„ã‚¿ãƒ–ç”Ÿæˆã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        async function loadAndSetupDynamicTabs() {
            try {
                // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¨­å®šã¨æœ‰åŠ¹ã‚¢ãƒ—ãƒªã‚’å–å¾—
                const response = await fetch('/api/config');
                if (!response.ok) {
                    throw new Error('è¨­å®šå–å¾—ã«å¤±æ•—');
                }
                
                const data = await response.json();
                const config = data.config;
                const loadedApps = data.loadedApps || [];
                
                // ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’æ›´æ–°
                updateVersionInfo(config);
                
                // æœ‰åŠ¹ã‚¢ãƒ—ãƒªæ•°ã‚’æ›´æ–°
                document.getElementById('enabledApps').textContent = `${loadedApps.length}å€‹`;
                
                // ã‚¿ãƒ–ã‚’å‹•çš„ç”Ÿæˆ
                generateDynamicTabs(loadedApps);
                
                // ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
                setupTabs();
                
                console.log(`âœ… å‹•çš„ã‚¿ãƒ–ç”Ÿæˆå®Œäº† | ã‚¢ãƒ—ãƒªæ•°: ${loadedApps.length}å€‹`);
                
            } catch (error) {
                console.error('âŒ å‹•çš„ã‚¿ãƒ–ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: åŸºæœ¬ã‚¿ãƒ–ã®ã¿ç”Ÿæˆ
                generateBasicTabs();
                setupTabs();
                document.getElementById('enabledApps').textContent = '0å€‹ (ã‚¨ãƒ©ãƒ¼)';
            }
        }
        
        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’æ›´æ–°
        function updateVersionInfo(config) {
            const configVersion = config.version || 'ä¸æ˜';
            const serverVersion = config.serverVersion || '2.0.0'; // ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒƒã‚¸ã‚’æ›´æ–°
            const versionBadge = document.querySelector('.version-badge');
            if (versionBadge) {
                versionBadge.textContent = `v${configVersion}`;
            }
            
            // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°
            const versionElement = document.getElementById('version');
            if (versionElement) {
                versionElement.textContent = `${configVersion} (ã‚µãƒ¼ãƒãƒ¼: ${serverVersion})`;
            }
            
            console.log(`ğŸ“‹ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±æ›´æ–°: Config v${configVersion}, Server v${serverVersion}`);
        }
        
        // å‹•çš„ã‚¿ãƒ–ã‚’ç”Ÿæˆ
        function generateDynamicTabs(loadedApps) {
            const tabsContainer = document.getElementById('appTabs');
            if (!tabsContainer) {
                console.error('âŒ ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒŠãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // æ—¢å­˜ã®ã‚¿ãƒ–ã‚’å‰Šé™¤
            tabsContainer.innerHTML = '';
            
            // åŸºæœ¬ã‚¿ãƒ–ã‚’ç”Ÿæˆ
            const basicTabs = [
                { name: 'simple', icon: 'ğŸ“„', displayName: 'ã‚·ãƒ³ãƒ—ãƒ«' },
                { name: 'settings', icon: 'âš™ï¸', displayName: 'è¨­å®š' },
                { name: 'logs', icon: 'ğŸ“‹', displayName: 'ãƒ­ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼' }
            ];
            
            basicTabs.forEach((tab, index) => {
                const tabElement = createTabElement(tab.name, tab.icon, tab.displayName, index === 0);
                tabsContainer.appendChild(tabElement);
            });
            
            // æœ‰åŠ¹ã‚¢ãƒ—ãƒªã®ã‚¿ãƒ–ã‚’ç”Ÿæˆï¼ˆåŸºæœ¬ã‚¿ãƒ–ã¨é‡è¤‡ã—ãªã„ã‚ˆã†ã«ï¼‰
            loadedApps.forEach(app => {
                // åŸºæœ¬ã‚¿ãƒ–ï¼ˆsimple, settings, logsï¼‰ã¨é‡è¤‡ã—ãªã„ã‹ãƒã‚§ãƒƒã‚¯
                const basicTabNames = ['simple', 'settings', 'logs'];
                if (!basicTabNames.includes(app.name)) {
                    const tabElement = createTabElement(app.name, app.icon, app.displayName, false);
                    tabsContainer.appendChild(tabElement);
                    
                    // ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã‚‚ç”Ÿæˆ
                    createAppContentArea(app);
                } else {
                    console.log(`ğŸ“„ ã‚¹ã‚­ãƒƒãƒ—: ${app.name} ã¯åŸºæœ¬ã‚¿ãƒ–ã®ãŸã‚é‡è¤‡å›é¿`);
                }
            });
            
            console.log(`ğŸ“„ ã‚¿ãƒ–ç”Ÿæˆå®Œäº†: åŸºæœ¬3å€‹ + ã‚¢ãƒ—ãƒª${loadedApps.length}å€‹`);
        }
        
        // åŸºæœ¬ã‚¿ãƒ–ã®ã¿ç”Ÿæˆï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
        function generateBasicTabs() {
            const tabsContainer = document.getElementById('appTabs');
            if (!tabsContainer) return;
            
            tabsContainer.innerHTML = '';
            const basicTabs = [
                { name: 'simple', icon: 'ğŸ“„', displayName: 'ã‚·ãƒ³ãƒ—ãƒ«' },
                { name: 'settings', icon: 'âš™ï¸', displayName: 'è¨­å®š' },
                { name: 'logs', icon: 'ğŸ“‹', displayName: 'ãƒ­ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼' }
            ];
            
            basicTabs.forEach((tab, index) => {
                const tabElement = createTabElement(tab.name, tab.icon, tab.displayName, index === 0);
                tabsContainer.appendChild(tabElement);
            });
        }
        
        // ã‚¿ãƒ–è¦ç´ ã‚’ä½œæˆ
        function createTabElement(name, icon, displayName, isActive = false) {
            const tab = document.createElement('button');
            tab.className = `app-tab${isActive ? ' active' : ''}`;
            tab.setAttribute('data-app', name);
            
            const iconSpan = document.createElement('span');
            iconSpan.className = 'icon';
            iconSpan.textContent = icon;
            
            const nameSpan = document.createElement('span');
            nameSpan.textContent = displayName;
            
            tab.appendChild(iconSpan);
            tab.appendChild(nameSpan);
            
            return tab;
        }
        
        // ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã‚’ä½œæˆ
        function createAppContentArea(app) {
            const mainContent = document.querySelector('.main-content');
            if (!mainContent) return;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'app-content';
            contentDiv.id = `${app.name}-content`;
            contentDiv.innerHTML = `
                <div class="welcome-content">
                    <h2>${app.icon} ${app.displayName}</h2>
                    <p>${app.description}</p>
                    <p>ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ${app.version}</p>
                    <div class="status status-success">
                        <span>âœ…</span>
                        <span>ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ</span>
                    </div>
                </div>
            `;
            
            mainContent.appendChild(contentDiv);
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function setupTabs() {
            document.querySelectorAll('.app-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const appName = this.getAttribute('data-app');
                    switchTab(appName);
                });
            });
        }
        
        function switchTab(appName) {
            // å…¨ã‚¿ãƒ–ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
            document.querySelectorAll('.app-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
            document.querySelectorAll('.app-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
            const selectedTab = document.querySelector(`[data-app="${appName}"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // é¸æŠã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
            const selectedContent = document.getElementById(`${appName}-content`);
            if (selectedContent) {
                selectedContent.style.display = 'block';
                
                // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ™‚ã®åˆæœŸåŒ–å‡¦ç†
                if (appName === 'settings') {
                    loadConfigUI();
                } else if (appName === 'logs') {
                    refreshLogs();
                }
            }
            
            console.log(`ğŸ“„ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ: ${appName}`);
        }
        
        // è¨­å®šèª­ã¿è¾¼ã¿æ©Ÿèƒ½
        async function loadConfigUI() {
            try {
                const response = await fetch('/api/config');
                const data = await response.json();
                
                // ã‚¢ãƒ—ãƒªè¨­å®šè¡¨ç¤º
                const appsContainer = document.getElementById('enabledAppsCheckboxes');
                if (appsContainer) {
                    let html = '';
                    const availableApps = {
                        'memo': { name: 'ãƒ¡ãƒ¢ç®¡ç†', icon: 'ğŸ“' },
                        'money': { name: 'ãŠé‡‘ç®¡ç†', icon: 'ğŸ’°' },
                        'time': { name: 'æ™‚é–“ç®¡ç†', icon: 'â°' },
                        'weight': { name: 'ä½“é‡ç®¡ç†', icon: 'âš–ï¸' },
                        'calc': { name: 'è¨ˆç®—æ©Ÿ', icon: 'ğŸ§®' }
                    };
                    
                    Object.entries(availableApps).forEach(([key, app]) => {
                        const isEnabled = data.config.enabledApps.includes(key);
                        html += `
                            <div class="checkbox-item ${isEnabled ? 'enabled' : ''}">
                                <input type="checkbox" id="app-${key}" value="${key}" ${isEnabled ? 'checked' : ''}>
                                <label for="app-${key}">
                                    <span class="app-icon">${app.icon}</span>
                                    ${app.name}
                                </label>
                            </div>
                        `;
                    });
                    appsContainer.innerHTML = html;
                }
                
                // æ©Ÿèƒ½è¨­å®šè¡¨ç¤º
                const featuresContainer = document.getElementById('featuresCheckboxes');
                if (featuresContainer) {
                    let html = '';
                    const features = {
                        'firebaseAuth': 'Firebaseèªè¨¼',
                        'csvExport': 'CSVå‡ºåŠ›',
                        'debugMode': 'ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰'
                    };
                    
                    Object.entries(features).forEach(([key, name]) => {
                        const isEnabled = data.config.features[key];
                        html += `
                            <div class="checkbox-item ${isEnabled ? 'enabled' : ''}">
                                <input type="checkbox" id="feature-${key}" value="${key}" ${isEnabled ? 'checked' : ''}>
                                <label for="feature-${key}">${name}</label>
                            </div>
                        `;
                    });
                    featuresContainer.innerHTML = html;
                }
                
                console.log('âš™ï¸ è¨­å®šèª­ã¿è¾¼ã¿å®Œäº†');
            } catch (error) {
                console.error('âŒ è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        async function saveConfigUI() { 
            try {
                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰è¨­å®šã‚’åé›†
                const enabledApps = [];
                const enabledFeatures = {};
                
                // æœ‰åŠ¹ã‚¢ãƒ—ãƒªã‚’ãƒã‚§ãƒƒã‚¯
                document.querySelectorAll('#enabledAppsCheckboxes input[type="checkbox"]:checked').forEach(checkbox => {
                    enabledApps.push(checkbox.value);
                });
                
                // æ©Ÿèƒ½è¨­å®šã‚’ãƒã‚§ãƒƒã‚¯
                document.querySelectorAll('#featuresCheckboxes input[type="checkbox"]').forEach(checkbox => {
                    enabledFeatures[checkbox.value] = checkbox.checked;
                });
                
                // ã‚µãƒ¼ãƒãƒ¼ã«è¨­å®šã‚’é€ä¿¡
                const response = await fetch('/api/config/save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        enabledApps: enabledApps,
                        features: enabledFeatures
                    })
                });
                
                if (response.ok) {
                    alert('âœ… è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ã‚¿ãƒ–ã‚’æ›´æ–°ã—ã¾ã™ã€‚');
                    console.log('ğŸ’¾ è¨­å®šä¿å­˜å®Œäº†');
                    
                    // è¨­å®šä¿å­˜å¾Œã€å‹•çš„ã‚¿ãƒ–ã‚’æ›´æ–°
                    await loadAndSetupDynamicTabs();
                    
                } else {
                    alert('âŒ è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
                    console.error('ğŸ’¾ è¨­å®šä¿å­˜å¤±æ•—');
                }
                
            } catch (error) {
                alert('âŒ è¨­å®šä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                console.error('ğŸ’¾ è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function resetConfig() { console.log('ğŸ”„ è¨­å®šãƒªã‚»ãƒƒãƒˆ'); }
        function loadConfig() { console.log('ğŸ“¥ JSONè¨­å®šèª­ã¿è¾¼ã¿'); }
        
        async function saveConfig() { 
            try {
                const configText = document.getElementById('configEditor').value;
                const config = JSON.parse(configText);
                
                const response = await fetch('/api/config/save-json', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                
                if (response.ok) {
                    alert('âœ… JSONè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚');
                    console.log('ğŸ’¾ JSONè¨­å®šä¿å­˜å®Œäº†');
                } else {
                    alert('âŒ JSONè¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
                    console.error('ğŸ’¾ JSONè¨­å®šä¿å­˜å¤±æ•—');
                }
                
            } catch (error) {
                alert('âŒ JSONè¨­å®šä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                console.error('ğŸ’¾ JSONè¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ãƒ­ã‚°æ©Ÿèƒ½ - ãƒãƒ¼ã‚¸ãƒ§ãƒ³è‡ªå‹•å–å¾—
        let currentVersion = 'å–å¾—ä¸­...';
        let systemLogs = [];
        
        // config.jsonã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‹•çš„å–å¾—
        async function loadVersionFromConfig() {
            try {
                const response = await fetch('/config.json');
                const config = await response.json();
                currentVersion = config.version || 'ä¸æ˜';
                
                // ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—å¾Œã«ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã‚’åˆæœŸåŒ–
                const timestamp = new Date().toTimeString().slice(0,8);
                systemLogs = [
                    `[${timestamp}] ğŸš€ çµ±åˆã‚¢ãƒ—ãƒªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹`,
                    `[${timestamp}] ğŸ“‹ è¨­å®šèª­ã¿è¾¼ã¿å®Œäº† | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ${currentVersion}`,  
                    `[${timestamp}] ğŸ“ ãƒ¡ãƒ¢ç®¡ç†ã‚¢ãƒ—ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–å®Œäº†`,
                    `[${timestamp}] âœ… ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†`
                ];
                
                // ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°è¡¨ç¤ºã‚’æ›´æ–°
                refreshLogs();
                console.log(`âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ${currentVersion} ã§åˆæœŸåŒ–å®Œäº†`);
            } catch (error) {
                console.error('âŒ config.jsonèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: package.jsonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨
                currentVersion = '0.8'; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤
                
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚ã§ã‚‚ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã‚’åˆæœŸåŒ–
                const timestamp = new Date().toTimeString().slice(0,8);
                systemLogs = [
                    `[${timestamp}] ğŸš€ çµ±åˆã‚¢ãƒ—ãƒªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹`,
                    `[${timestamp}] ğŸ“‹ è¨­å®šèª­ã¿è¾¼ã¿å®Œäº† | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ${currentVersion} (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯)`,  
                    `[${timestamp}] ğŸ“ ãƒ¡ãƒ¢ç®¡ç†ã‚¢ãƒ—ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–å®Œäº†`,
                    `[${timestamp}] âœ… ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†`
                ];
                
                refreshLogs();
                console.log(`âš ï¸ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ${currentVersion} ã‚’ä½¿ç”¨`);
            }
        }
        
        // éå»ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
        let availableLogFiles = [];
        
        async function loadLogFiles() { 
            try {
                // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—
                const response = await fetch('/api/logs/files');
                if (response.ok) {
                    const data = await response.json();
                    availableLogFiles = data.files.map(file => file.name);
                    updateLogFileSelect();
                    console.log(`ğŸ”„ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§æ›´æ–°: ${availableLogFiles.length}ä»¶`);
                } else {
                    console.log('ğŸ”„ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§æ›´æ–°ï¼ˆã‚µãƒ¼ãƒãƒ¼æ©Ÿèƒ½æœªå®Ÿè£…ï¼‰');
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: æ—¢çŸ¥ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« + å‹•ä½œç¢ºèªãƒ•ã‚¡ã‚¤ãƒ«
                    const today = new Date().toISOString().slice(0,10);
                    availableLogFiles = [
                        'test-download-2025-07-24.json',
                        'verification-result-2025-07-24.json',
                        `å‹•ä½œç¢ºèª-æ‰‹å‹•-${today}.json`,
                        `å‹•ä½œç¢ºèª-è‡ªå‹•-${today}.json`
                    ];
                    updateLogFileSelect();
                }
            } catch (error) {
                console.log('ğŸ”„ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§æ›´æ–°ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰');
                const today = new Date().toISOString().slice(0,10);
                availableLogFiles = [
                    'test-download-2025-07-24.json',
                    'verification-result-2025-07-24.json',
                    `å‹•ä½œç¢ºèª-æ‰‹å‹•-${today}.json`,
                    `å‹•ä½œç¢ºèª-è‡ªå‹•-${today}.json`
                ];
                updateLogFileSelect();
            }
        }
        
        function updateLogFileSelect() {
            const select = document.getElementById('logFileSelect');
            if (select) {
                select.innerHTML = '<option value="">å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</option>';
                availableLogFiles.forEach(filename => {
                    const option = document.createElement('option');
                    option.value = filename;
                    option.textContent = filename;
                    select.appendChild(option);
                });
            }
        }
        
        async function loadSelectedLog() { 
            const select = document.getElementById('logFileSelect');
            const logDisplay = document.getElementById('logDisplay');
            
            if (!select.value) {
                console.log('ğŸ“„ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            try {
                const response = await fetch(`/api/logs/content/${select.value}`);
                if (response.ok) {
                    const data = await response.json();
                    const logContent = data.lines.map(line => line.content).join('\n');
                    if (logDisplay) {
                        logDisplay.textContent = logContent;
                        resetFilterData(); // æ–°ã—ã„ãƒ­ã‚°èª­ã¿è¾¼ã¿æ™‚ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
                    }
                    console.log(`ğŸ“„ å€‹åˆ¥ãƒ­ã‚°èª­ã¿è¾¼ã¿: ${select.value}`);
                } else {
                    if (logDisplay) {
                        logDisplay.textContent = `ã‚¨ãƒ©ãƒ¼: ${select.value} ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ`;
                    }
                    console.error(`âŒ ãƒ­ã‚°èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${select.value}`);
                }
            } catch (error) {
                if (logDisplay) {
                    logDisplay.textContent = `ã‚¨ãƒ©ãƒ¼: ${error.message}`;
                }
                console.error('âŒ ãƒ­ã‚°èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        async function loadAllLogs() {
            const logDisplay = document.getElementById('logDisplay');
            
            if (!logDisplay) {
                console.error('âŒ logDisplayè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // ğŸ›¡ï¸ é‡è¦: ã“ã‚Œã¯éå»ã®ä¿å­˜æ¸ˆã¿ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€æ©Ÿèƒ½
            // ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°(systemLogs)ã¨ã¯å®Œå…¨ã«åˆ¥ç‰©
            
            logDisplay.textContent = 'ğŸ“š å…¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ä¸­...';
            
            try {
                let allLogsContent = `=== å…¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬è¡¨ç¤º ===\nğŸ“‚ èª­ã¿è¾¼ã¿äºˆå®š: ${availableLogFiles.length}ãƒ•ã‚¡ã‚¤ãƒ«\n\n`;
                
                for (let i = 0; i < availableLogFiles.length; i++) {
                    const filename = availableLogFiles[i];
                    try {
                        const response = await fetch(`/api/logs/content/${filename}`);
                        if (response.ok) {
                            const data = await response.json();
                            const content = data.lines.map(line => line.content).join('\n');
                            allLogsContent += `ğŸ“„ [${i + 1}/${availableLogFiles.length}] ${filename}\n`;
                            allLogsContent += `ğŸ“Š ã‚µã‚¤ã‚º: ${content.length}æ–‡å­— | è¡Œæ•°: ${content.split('\n').length}è¡Œ\n`;
                            allLogsContent += 'â•'.repeat(60) + '\n';
                            allLogsContent += content + '\n';
                            allLogsContent += 'â•'.repeat(60) + '\n\n';
                        }
                    } catch (error) {
                        allLogsContent += `âŒ [${i + 1}/${availableLogFiles.length}] ${filename}: èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼\n\n`;
                    }
                }
                
                logDisplay.textContent = allLogsContent;
                resetFilterData(); // å…¨ãƒ­ã‚°èª­ã¿è¾¼ã¿æ™‚ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
                console.log(`ğŸ“š å…¨ãƒ­ã‚°ä¸€æ‹¬è¡¨ç¤ºå®Œäº†: ${availableLogFiles.length}ãƒ•ã‚¡ã‚¤ãƒ«`);
                
            } catch (error) {
                logDisplay.textContent = `ã‚¨ãƒ©ãƒ¼: å…¨ãƒ­ã‚°èª­ã¿è¾¼ã¿ã«å¤±æ•—\n${error.message}`;
                console.error('âŒ å…¨ãƒ­ã‚°èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨ã«å…ƒãƒ­ã‚°å†…å®¹ã‚’ä¿å­˜
        let originalLogContent = '';
        let filterTimeout = null;
        
        function filterLogLines() { 
            const searchTerm = document.getElementById('logSearchInput').value.toLowerCase();
            const logDisplay = document.getElementById('logDisplay');
            const searchResultCount = document.getElementById('searchResultCount');
            
            // ğŸ›¡ï¸ é‡è¦: ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°(debugLogs)ã¯çµ¶å¯¾ã«å¤‰æ›´ã—ãªã„ï¼
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ã€Œãƒ­ã‚°ã€ã‚¿ãƒ–ã®éå»ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®ã¿ã«é©ç”¨
            
            if (!logDisplay) {
                console.error('âŒ logDisplayè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // åˆå›ã¾ãŸã¯å…ƒãƒ‡ãƒ¼ã‚¿ãŒç©ºã®å ´åˆã¯å…ƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
            if (!originalLogContent && logDisplay.textContent) {
                originalLogContent = logDisplay.textContent;
            }
            
            if (!searchTerm) {
                // æ¤œç´¢èªãŒç©ºã®å ´åˆã€å…ƒã®ãƒ­ã‚°å†…å®¹ã‚’å¾©å…ƒ
                logDisplay.textContent = originalLogContent;
                const lineCount = originalLogContent.split('\n').length;
                if (searchResultCount) searchResultCount.textContent = `${lineCount}è¡Œ`;
                console.log('ğŸ”„ å…ƒãƒ­ã‚°å†…å®¹ã‚’å¾©å…ƒï¼ˆéå»ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰');
                return;
            }
            
            // å…ƒãƒ­ã‚°å†…å®¹ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆsystemLogsã¯ä½¿ã‚ãªã„ï¼‰
            const lines = originalLogContent.split('\n');
            const filteredLines = lines.filter(line => 
                line.toLowerCase().includes(searchTerm)
            );
            
            // æ¤œç´¢çµæœã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºï¼ˆè¦‹ã‚„ã™ã„å½¢å¼ã«å¤‰æ›´ï¼‰
            const highlightedLines = filteredLines.map(line => {
                const regex = new RegExp(`(${searchTerm})`, 'gi');
                return line.replace(regex, 'ã€$1ã€‘');
            });
            
            // è¡¨ç¤ºã‚’æ›´æ–°ï¼ˆéå»ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®ã¿ï¼‰
            if (filteredLines.length > 0) {
                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çµæœã®å…ˆé ­ã«æƒ…å ±ã‚’è¿½åŠ 
                const headerInfo = `ğŸ” æ¤œç´¢çµæœ: "${searchTerm}" (${filteredLines.length}è¡Œãƒãƒƒãƒ)\n` +
                                 `ğŸ“‚ å¯¾è±¡: ${getCurrentLogFileName()}\n` +
                                 `â”€`.repeat(50) + '\n';
                logDisplay.textContent = headerInfo + highlightedLines.join('\n');
            } else {
                logDisplay.textContent = `ğŸ” æ¤œç´¢çµæœ: "${searchTerm}" (0è¡Œãƒãƒƒãƒ)\n` +
                                       `ğŸ“‚ å¯¾è±¡: ${getCurrentLogFileName()}\n` +
                                       `â”€`.repeat(50) + '\n' +
                                       `"${searchTerm}" ã«ä¸€è‡´ã™ã‚‹è¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`;
            }
            
            if (searchResultCount) {
                searchResultCount.textContent = `${filteredLines.length}è¡Œ`;
            }
            
            // ãƒ‡ãƒã‚¦ãƒ³ã‚¹: ãƒ­ã‚°å‡ºåŠ›ã‚’åˆ¶é™
            if (filterTimeout) clearTimeout(filterTimeout);
            filterTimeout = setTimeout(() => {
                console.log(`ğŸ” éå»ãƒ­ã‚°æ¤œç´¢: "${searchTerm}" -> ${filteredLines.length}è¡Œ`);
            }, 500); // 500mså¾Œã«ãƒ­ã‚°å‡ºåŠ›
        }
        
        // ãƒ­ã‚°å†…å®¹ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰å…ƒãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetFilterData() {
            originalLogContent = '';
        }
        
        // ç¾åœ¨è¡¨ç¤ºä¸­ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
        function getCurrentLogFileName() {
            const select = document.getElementById('logFileSelect');
            if (select && select.value) {
                return select.value;
            }
            
            // å…¨ãƒ­ã‚°ä¸€æ‹¬è¡¨ç¤ºã®å ´åˆ
            if (originalLogContent.includes('=== å…¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬è¡¨ç¤º ===')) {
                return `å…¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« (${availableLogFiles.length}ãƒ•ã‚¡ã‚¤ãƒ«)`;
            }
            
            return 'ä¸æ˜ãªãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«';
        }
        
        function clearLogSearch() { 
            document.getElementById('logSearchInput').value = '';
            filterLogLines(); // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚¯ãƒªã‚¢
            console.log('ğŸ—‘ï¸ æ¤œç´¢ã‚¯ãƒªã‚¢'); 
        }
        
        function downloadLogs() { 
            try {
                // å‹•ä½œç¢ºèªç”¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆï¼ˆæ™‚é–“å«ã¿ãƒ•ã‚¡ã‚¤ãƒ«åç”¨ï¼‰
                const now = new Date();
                const timestamp = now.toISOString().replace(/[:.]/g, '-');
                const dateTimeString = now.toISOString().slice(0,19).replace('T', '_').replace(/:/g, '-');
                const testData = {
                    exportedAt: new Date().toISOString(),
                    version: currentVersion,
                    testPurpose: "å‹•ä½œç¢ºèªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ",
                    systemLogs: systemLogs,
                    userAgent: navigator.userAgent,
                    success: true,
                    testType: "manual-download"
                };
                
                // JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const dataStr = JSON.stringify(testData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const downloadLink = document.createElement('a');
                downloadLink.href = url;
                downloadLink.download = `test-download-${dateTimeString}.json`;
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // ãƒ¡ãƒ¢ãƒªè§£æ”¾
                URL.revokeObjectURL(url);
                
                console.log(`ğŸ“¥ ãƒ­ã‚°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†: test-download-${timestamp.slice(0,10)}.json`);
            } catch (error) {
                console.error('âŒ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        function copyLogsToClipboard() { console.log('ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼'); }
        function clearLogs() { 
            document.getElementById('debugLogs').textContent = 'ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ';
            console.log('ğŸ—‘ï¸ ãƒ­ã‚°ã‚¯ãƒªã‚¢'); 
        }
        function refreshLogs() { 
            document.getElementById('debugLogs').textContent = systemLogs.join('\n');
            console.log('ğŸ”„ ãƒ­ã‚°æ›´æ–°'); 
        }

        // çµ±åˆå‹•ä½œç¢ºèªã‚·ã‚¹ãƒ†ãƒ 
        async function runFullSystemVerification() {
            const verificationSection = document.getElementById('verificationSection');
            const statusIndicator = document.getElementById('statusIndicator');
            const verificationDetails = document.getElementById('verificationDetails');
            const verificationEvidence = document.getElementById('verificationEvidence');
            const verificationBtn = document.getElementById('verificationBtn');
            
            // åˆæœŸåŒ–
            verificationSection.style.display = 'block';
            statusIndicator.textContent = 'ğŸ”„ çµ±åˆå‹•ä½œç¢ºèªå®Ÿè¡Œä¸­...';
            statusIndicator.className = 'status-indicator running';
            verificationBtn.disabled = true;
            verificationBtn.textContent = 'ğŸ”„ ç¢ºèªä¸­...';
            
            console.log('ğŸ§ª çµ±åˆå‹•ä½œç¢ºèªé–‹å§‹');
            
            const results = {
                step1: false, // ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
                step2: false, // å…±é€šæ©Ÿèƒ½ç¢ºèª  
                step3: false, // ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª
                step4: false, // ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª
                overall: false
            };
            
            try {
                // STEP1: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
                updateVerificationStep('step1', 'running', 'ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèªä¸­...');
                const serverCheck = await checkServerStatus();
                results.step1 = serverCheck;
                updateVerificationStep('step1', serverCheck ? 'success' : 'failed', 
                    serverCheck ? 'âœ… ã‚µãƒ¼ãƒãƒ¼æ­£å¸¸å‹•ä½œ' : 'âŒ ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šå¤±æ•—');
                
                // STEP2: å…±é€šæ©Ÿèƒ½ç¢ºèª
                updateVerificationStep('step2', 'running', 'å…±é€šæ©Ÿèƒ½ç¢ºèªä¸­...');
                const commonFeaturesCheck = await checkCommonFeatures();
                results.step2 = commonFeaturesCheck;
                updateVerificationStep('step2', commonFeaturesCheck ? 'success' : 'failed',
                    commonFeaturesCheck ? 'âœ… å…±é€šæ©Ÿèƒ½æ­£å¸¸' : 'âŒ å…±é€šæ©Ÿèƒ½ã‚¨ãƒ©ãƒ¼');
                
                // STEP3: ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª
                updateVerificationStep('step3', 'running', 'ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèªä¸­...');
                const pageCheck = await checkPageFunctions();
                results.step3 = pageCheck;
                updateVerificationStep('step3', pageCheck ? 'success' : 'failed',
                    pageCheck ? 'âœ… ãƒšãƒ¼ã‚¸æ©Ÿèƒ½æ­£å¸¸' : 'âŒ ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ã‚¨ãƒ©ãƒ¼');
                
                // STEP4: ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª
                updateVerificationStep('step4', 'running', 'ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèªä¸­...');
                const logCheck = await checkLogFunctions();
                results.step4 = logCheck;
                updateVerificationStep('step4', logCheck ? 'success' : 'failed',
                    logCheck ? 'âœ… ãƒ­ã‚°æ©Ÿèƒ½æ­£å¸¸' : 'âŒ ãƒ­ã‚°æ©Ÿèƒ½ã‚¨ãƒ©ãƒ¼');
                
                // ç·åˆåˆ¤å®š
                results.overall = results.step1 && results.step2 && results.step3 && results.step4;
                
                // çµæœè¡¨ç¤º
                if (results.overall) {
                    statusIndicator.textContent = 'ğŸ‰ å…¨æ©Ÿèƒ½å‹•ä½œç¢ºèªæˆåŠŸï¼';
                    statusIndicator.className = 'status-indicator success';
                } else {
                    statusIndicator.textContent = 'âš ï¸ ä¸€éƒ¨æ©Ÿèƒ½ã§å•é¡Œã‚’æ¤œå‡º';
                    statusIndicator.className = 'status-indicator failed';
                }
                
                // ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ç”Ÿæˆ
                const evidence = generateEvidence(results);
                verificationEvidence.textContent = evidence;
                
                // å‹•ä½œç¢ºèªå®Œäº†æ™‚ã«è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                await downloadVerificationResult(results, 'æ‰‹å‹•');
                
                console.log('ğŸ§ª çµ±åˆå‹•ä½œç¢ºèªå®Œäº†:', results);
                
            } catch (error) {
                console.error('âŒ çµ±åˆå‹•ä½œç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
                statusIndicator.textContent = 'âŒ å‹•ä½œç¢ºèªã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ';
                statusIndicator.className = 'status-indicator failed';
                verificationEvidence.textContent = `ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            } finally {
                verificationBtn.disabled = false;
                verificationBtn.textContent = 'ğŸ§ª å…¨æ©Ÿèƒ½å‹•ä½œç¢ºèª';
            }
        }
        
        function updateVerificationStep(stepId, status, message) {
            let stepElement = document.getElementById(stepId);
            if (!stepElement) {
                stepElement = document.createElement('div');
                stepElement.id = stepId;
                stepElement.className = 'verification-step';
                document.getElementById('verificationDetails').appendChild(stepElement);
            }
            
            stepElement.className = `verification-step ${status}`;
            stepElement.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${getStepTitle(stepId)}</div>
                <div>${message}</div>
            `;
        }
        
        function getStepTitle(stepId) {
            const titles = {
                step1: 'STEP1: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª',
                step2: 'STEP2: å…±é€šæ©Ÿèƒ½ç¢ºèª',
                step3: 'STEP3: ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª',
                step4: 'STEP4: ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª'
            };
            return titles[stepId] || stepId;
        }
        
        async function checkServerStatus() {
            try {
                const response = await fetch(window.location.href);
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        async function checkCommonFeatures() {
            try {
                // Firebaseè¨­å®šãƒã‚§ãƒƒã‚¯
                const hasFirebase = typeof firebase !== 'undefined';
                // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯
                const hasModuleLoader = document.querySelector('[data-module]') !== null;
                // åŸºæœ¬UIè¦ç´ ãƒã‚§ãƒƒã‚¯
                const hasHeader = document.querySelector('header') !== null;
                const hasNavigation = document.querySelector('.app-tabs') !== null;
                
                return hasFirebase && hasHeader && hasNavigation;
            } catch (error) {
                return false;
            }
        }
        
        async function checkPageFunctions() {
            try {
                // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ãƒã‚§ãƒƒã‚¯ï¼ˆæ­£ã—ã„ã‚¯ãƒ©ã‚¹åã«ä¿®æ­£ï¼‰
                const tabs = document.querySelectorAll('.app-tab');
                const contents = document.querySelectorAll('.app-content');
                
                // è¨­å®šãƒšãƒ¼ã‚¸ãƒã‚§ãƒƒã‚¯
                const settingsTab = document.querySelector('[data-app="settings"]');
                const logsTab = document.querySelector('[data-app="logs"]');
                
                // ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
                const header = document.querySelector('header');
                const navigation = document.querySelector('.app-tabs');
                
                console.log('ğŸ” ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª:', {
                    tabs: tabs.length,
                    contents: contents.length,
                    settingsTab: !!settingsTab,
                    logsTab: !!logsTab,
                    header: !!header,
                    navigation: !!navigation
                });
                
                return tabs.length > 0 && contents.length > 0 && settingsTab && logsTab && header && navigation;
            } catch (error) {
                console.error('âŒ ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
                return false;
            }
        }
        
        async function checkLogFunctions() {
            try {
                // ãƒ­ã‚°è¡¨ç¤ºè¦ç´ ãƒã‚§ãƒƒã‚¯
                const logElement = document.getElementById('debugLogs');
                const logControlsExist = document.querySelector('.log-controls') !== null;
                
                // ãƒ­ã‚°ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
                const functionsExist = typeof downloadLogs === 'function' &&
                                     typeof clearLogs === 'function' &&
                                     typeof refreshLogs === 'function';
                
                return logElement !== null && logControlsExist && functionsExist;
            } catch (error) {
                return false;
            }
        }
        
        function generateEvidence(results) {
            const timestamp = new Date().toISOString();
            const evidence = {
                timestamp: timestamp,
                version: `v${currentVersion}`,
                testType: 'ãƒ–ãƒ©ã‚¦ã‚¶çµ±åˆå‹•ä½œç¢ºèª',
                results: results,
                userAgent: navigator.userAgent,
                url: window.location.href
            };
            
            return JSON.stringify(evidence, null, 2);
        }
        
        // å‹•ä½œç¢ºèªçµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        async function downloadVerificationResult(results, testType) {
            try {
                const now = new Date();
                const timestamp = now.toISOString().replace(/[:.]/g, '-');
                const dateTimeStamp = now.toISOString().slice(0,19).replace('T', '_').replace(/:/g, '-'); // YYYY-MM-DD_HH-MM-SS
                
                const testData = {
                    exportedAt: new Date().toISOString(),
                    version: currentVersion,
                    testType: testType, // 'æ‰‹å‹•' ã¾ãŸã¯ 'è‡ªå‹•'
                    testPurpose: `${testType}å‹•ä½œç¢ºèªã®è¨¼è·¡`,
                    verificationResults: results,
                    systemLogs: systemLogs,
                    userAgent: navigator.userAgent,
                    url: window.location.href,
                    overall: results.overall
                };
                
                // JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const dataStr = JSON.stringify(testData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const downloadLink = document.createElement('a');
                downloadLink.href = url;
                downloadLink.download = `å‹•ä½œç¢ºèª-${testType}-${dateTimeStamp}.json`;
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // ãƒ¡ãƒ¢ãƒªè§£æ”¾
                URL.revokeObjectURL(url);
                
                // ã‚µãƒ¼ãƒãƒ¼ã«ã‚‚ãƒ†ã‚¹ãƒˆçµæœã‚’ä¿å­˜
                await saveTestResultToServer(testData, `å‹•ä½œç¢ºèª-${testType}-${dateTimeStamp}.json`);
                
                console.log(`ğŸ“¥ å‹•ä½œç¢ºèªçµæœãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†: å‹•ä½œç¢ºèª-${testType}-${dateTimeStamp}.json`);
                return `å‹•ä½œç¢ºèª-${testType}-${dateTimeStamp}.json`;
            } catch (error) {
                console.error('âŒ å‹•ä½œç¢ºèªçµæœãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
                return null;
            }
        }
        
        // ãƒ†ã‚¹ãƒˆçµæœã‚’ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜
        async function saveTestResultToServer(testData, filename) {
            try {
                const response = await fetch('/api/logs/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        filename: filename,
                        data: testData,
                        testType: 'verification'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log(`ğŸ“ ãƒ†ã‚¹ãƒˆçµæœã‚µãƒ¼ãƒãƒ¼ä¿å­˜å®Œäº†: ${filename}`);
                    
                    // ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’æ›´æ–°
                    await loadLogFiles();
                    
                    return result;
                } else {
                    console.warn(`âš ï¸ ãƒ†ã‚¹ãƒˆçµæœã‚µãƒ¼ãƒãƒ¼ä¿å­˜å¤±æ•—: ${response.status}`);
                    return null;
                }
            } catch (error) {
                console.warn('âš ï¸ ãƒ†ã‚¹ãƒˆçµæœã‚µãƒ¼ãƒãƒ¼ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error.message);
                return null;
            }
        }
        
        // è‡ªå‹•å‹•ä½œç¢ºèªæ©Ÿèƒ½
        async function runAutomaticVerification() {
            console.log('ğŸ¤– è‡ªå‹•å‹•ä½œç¢ºèªé–‹å§‹');
            
            // å°‘ã—å¾…ã£ã¦ã‹ã‚‰DOMè¦ç´ ãŒç¢ºå®Ÿã«åˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…æ©Ÿ
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            try {
                const results = {
                    step1: false, // ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
                    step2: false, // å…±é€šæ©Ÿèƒ½ç¢ºèª  
                    step3: false, // ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª
                    step4: false, // ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª
                    overall: false
                };
                
                // STEP1: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
                console.log('ğŸ¤– è‡ªå‹•ç¢ºèª STEP1: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª');
                const serverCheck = await checkServerStatus();
                results.step1 = serverCheck;
                
                // STEP2: å…±é€šæ©Ÿèƒ½ç¢ºèª
                console.log('ğŸ¤– è‡ªå‹•ç¢ºèª STEP2: å…±é€šæ©Ÿèƒ½ç¢ºèª');
                const commonFeaturesCheck = await checkCommonFeatures();
                results.step2 = commonFeaturesCheck;
                
                // STEP3: ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª
                console.log('ğŸ¤– è‡ªå‹•ç¢ºèª STEP3: ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ç¢ºèª');
                const pageCheck = await checkPageFunctions();
                results.step3 = pageCheck;
                
                // STEP4: ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª
                console.log('ğŸ¤– è‡ªå‹•ç¢ºèª STEP4: ãƒ­ã‚°æ©Ÿèƒ½ç¢ºèª');
                const logCheck = await checkLogFunctions();
                results.step4 = logCheck;
                
                // ç·åˆåˆ¤å®š
                results.overall = results.step1 && results.step2 && results.step3 && results.step4;
                
                // è‡ªå‹•ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const filename = await downloadVerificationResult(results, 'è‡ªå‹•');
                
                console.log('ğŸ¤– è‡ªå‹•å‹•ä½œç¢ºèªå®Œäº†:', results);
                console.log(`ğŸ“ ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: ${filename}`);
                
                return results;
            } catch (error) {
                console.error('âŒ è‡ªå‹•å‹•ä½œç¢ºèªã‚¨ãƒ©ãƒ¼:', error);
                return null;
            }
        }
        
        // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã«ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚’å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“„ DOMèª­ã¿è¾¼ã¿å®Œäº†');
            loadVersionFromConfig();
            loadLogFiles();
            
            // æ³¨æ„: è‡ªå‹•å‹•ä½œç¢ºèªã¯Claudeå´ã§automated-verification.jsã‚’ç›´æ¥å®Ÿè¡Œ
            // Webãƒšãƒ¼ã‚¸ã§ã¯è‡ªå‹•å®Ÿè¡Œã›ãšã€æ‰‹å‹•ãƒœã‚¿ãƒ³ã®ã¿æä¾›
        });
        
        console.log('âœ… ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº† - v0.8è‡ªå‹•å‹•ä½œç¢ºèªç‰ˆãƒ»è¨¼è·¡ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆå¯¾å¿œ');
    </script>
</body>
</html>
